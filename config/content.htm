<h1>About</h1>
<p>Repo: <a href="https://github.com/mdecycu/cad2025">https://github.com/mdecycu/cad2025</a></p>
<p>Web: <a href="https://mde.tw/cad2025">https://mde.tw/cad2025</a></p>
<p>可攜程式套件:</p>
<p style="padding-left: 30px;"><a href="http://229.cycu.org/portable_2026.7z">portable_2026.7z</a> (387MB)</p>
<p style="padding-left: 60px;">解開壓縮後，雙點擊 start_miniconda3.bat 啟動可攜系統，雙點擊 stop.bat 關閉可攜系統。</p>
<p style="padding-left: 60px;">可攜系統啟動後，在命令列執行 conda activate y:\envs\cmsimde 可進入能執行 CMSiMDE 的環境。</p>
<p style="padding-left: 60px;">若希望可攜系統啟動直接進入 cmsimde 環境，可將 start_miniconda3.bat 檔案中第 98 行: call "%CONDA_ROOT%\Scripts\activate.bat" %ENV_NAME% 更換為 call "%CONDA_ROOT%\Scripts\activate.bat" %Disk%:\envs\cmsimde。</p>
<p style="padding-left: 30px;"><a href="http://229.cycu.org/cad_data.7z">cad_data.7z</a> (包括 NX2312、Blender4.2 與 Webots2023b，4.2GB)</p>
<p style="padding-left: 60px;">解開壓縮檔，將 nx、Webots_2023b 與 Blender 4.2 等目錄放入可攜系統的 data 目錄中。</p>
<p style="padding-left: 60px;">在命令列執行 webotsw 可啟動 Webots，設定 NX 使用授權後，執行 ugraf -nx 可啟動 NX2312。</p>
<p style="padding-left: 60px;">Webots2023b 啟動時需要 openssl_lh_set_thunks 函式，因為這是特別的 OpenSSL 介接，其目的可能是透過此函式與 OpenSSL 整合記憶體分配、除錯、或 OpenSSL 引擎擴充。</p>
<p style="padding-left: 60px;">目前已知 miniconda 中必須透過 conda install openssl=3.0.16 安裝舊版後的 openssl-3-x64.dll 中才會包含openssl_lh_set_thunks 函式。</p>
<p style="padding-left: 30px;"><a href="https://learn.microsoft.com/zh-tw/cpp/windows/latest-supported-vc-redist?view=msvc-170">Microsoft Visual C++ 可轉散發套件</a> (<a href="https://drive.google.com/file/d/10dzQbk_OT1Cm354rnk-2_sXwRRUmDrjK/view?usp=drive_link">VC_redist.x64.exe</a>)</p>
<p>Teams 線上教學:</p>
<p style="padding-left: 30px;">以 "學號@nfu.edu.tw" 登入<span> </span><a href="https://login.microsoftonline.com/">https://login.microsoftonline.com/</a><span> </span>Office 365</p>
<p style="padding-left: 30px;">MS Teams 團隊代碼: wpv2s7j</p>
<p>課程評分:</p>
<p style="padding-left: 30px;"><span style="background-color: #ffff00;">作業報告 (60%)</span> - MS Teams 線上參與，6人一組每三週發表作業心得。</p>
<p style="padding-left: 60px;">w3、w7、w10、w14、w17、w18</p>
<p style="padding-left: 30px;"><span style="background-color: #ffff00;">個人與分組網站維護 (40%)</span> - 每週至少兩次推送與課程進度相關的學習內容與心得。</p>
<p style="padding-left: 60px;">w9 期中自評、w18 期末自評</p>
<p>實習項目:</p>
<p style="padding-left: 30px;">如何維持教室整齊清潔?</p>
<p style="padding-left: 60px;">學員定期打掃 (由助教安排) </p>
<p style="padding-left: 60px;">學員自律</p>
<p style="padding-left: 30px;">如何善用教室與工作站室硬體?</p>
<p style="padding-left: 60px;">電腦設定</p>
<p style="padding-left: 60px;">網路連線</p>
<p style="padding-left: 60px;">課餘時間預約 (由助教安排) </p>
<p style="padding-left: 30px;">Five-bar Linkage: 五連桿平面繪圖機構系統的設計模擬與製作。</p>
<p style="padding-left: 60px;"><a href="https://mde.tw/cad2025/downloads/fivebar_parallel_linkage.7z">fivebar_parallel_linkage.7z</a> (in Solidworks and NX2312)</p>
<p style="padding-left: 60px;"><a href="/downloads/plotter.7z">plotter.7z</a> (in Solvespace)</p>
<p>行事曆:</p>
<p style="padding-left: 30px;">2a 上課時段: 每週五 13:20 - 16:10 (w5 10/10 國慶日放假, w11 11/21 全校運動會)</p>
<p style="padding-left: 30px;">2b 上課時段: 每週二 09:10 - 12:00</p>
<p><a href="https://calendar.google.com/calendar/embed?src=mde.nfu.edu.tw_3439313938333136353439%40resource.calendar.google.com&amp;ctz=Asia%2FTaipei&amp;mode=week&amp;src=mde.nfu.edu.tw_35303530373431313438%40resource.calendar.google.com&amp;ctz=Asia%2FTaipei&amp;src=yen%40gm.nfu.edu.tw&amp;ctz=Asia%2FTaipei"> 全頁檢視 </a></p>
<p><iframe height="600" src="https://calendar.google.com/calendar/embed?src=mde.nfu.edu.tw_3439313938333136353439%40resource.calendar.google.com&amp;ctz=Asia%2FTaipei&amp;mode=week&amp;src=mde.nfu.edu.tw_35303530373431313438%40resource.calendar.google.com&amp;ctz=Asia%2FTaipei&amp;src=yen%40gm.nfu.edu.tw&amp;ctz=Asia%2FTaipei" width="800"></iframe></p>
<h2>Mind-Map</h2>
<p><object data="/images/cad2025.svg" height="943" type="image/svg+xml" width="1321"></object></p>
<p><a href="https://mde.tw/mind-map/#/?fileURL=https://mde.tw/cad2025/downloads/cad2025.smm">Edit cad2025.smm</a></p>
<h2>Commands</h2>
<p>Allow ping ICMPv4 powershell:</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false"># Allow inbound ICMPv4 Echo Request (ping)
New-NetFirewallRule -Name "Allow ICMPv4-In" -DisplayName "Allow ICMPv4-In" -Protocol ICMPv4 -IcmpType 8 -Direction Inbound -Action Allow</pre>
<p>ICMPv6:</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false"># Allow inbound ICMPv6 Echo Request (ping)
New-NetFirewallRule -Name "Allow ICMPv6-In" -DisplayName "Allow ICMPv6-In" -Protocol ICMPv6 -IcmpType 128 -Direction Inbound -Action Allow</pre>
<p>允許 ICMP/ICMPv6 的安全性考量<br/><br/>ICMP（包括 ICMPv6）不只是用於 ping，它對許多網路功能來說都是必要的，尤其是在 IPv6 環境下。不過，開放 ICMP/ICMPv6 仍然會帶來一些安全性疑慮：<br/><br/>對於 IPv4（ICMP）：<br/><br/>- 攻擊者可以利用 ICMP 進行：<br/>    - 偵查：發現存活主機（ping 掃描）。<br/>    - 淹水攻擊：ICMP flood（阻斷服務攻擊）。<br/>    - 網路映射：例如透過 traceroute 等工具。<br/>- 緩解方式：通常會限制 ICMP 類型（如僅允許 Echo Request/Reply），或限制來源 IP，或進行流量速率限制。<br/><br/>對於 IPv6（ICMPv6）：<br/><br/>- ICMPv6 對於 IPv6 的運作至關重要！<br/>    - 它支援鄰居探索、路徑 MTU 探查，以及位址自動設定。<br/>    - 若封鎖 ICMPv6，可能會導致 IPv6 無法正常運作，因為路由器與主機都仰賴 ICMPv6 完成這些基本功能。<br/>- 安全性疑慮：<br/>    - 偵查：攻擊者仍可發現 IPv6 主機與網段。<br/>    - 潛在濫用：例如 ICMPv6 flood，或偽造鄰居請求（Neighbor Solicitation spoofing）。<br/>- 緩解方式：<br/>    - 不要完全封鎖 ICMPv6，而是只允許必要的訊息類型（如 128/129 為 Echo、133-136 為鄰居探索等）。<br/>    - 考慮使用流量速率限制與監控。<br/>    - 檢查防火牆的預設規則——Windows 及現代防火牆通常對 ICMPv6 已有安全的預設值。<br/><br/><br/></p>
<h3>Fourbar</h3>
<p><object data="/images/fourbar.svg" height="2126" type="image/svg+xml" width="3168"></object></p>
<p><a href="https://mde.tw/mind-map/#/?fileURL=https://mde.tw/cad2025/downloads/fourbar.smm">Edit fourbar.smm</a></p>
<h2>AI</h2>
<p><a href="https://grok.com">https://grok.com</a> </p>
<p><a href="https://github.com/copilot">https://github.com/copilot</a> </p>
<p><a href="https://chatgpt.com/">https://chatgpt.com/</a> </p>
<p><a href="https://gemini.google.com/app">https://gemini.google.com/app</a> </p>
<p><a href="https://chat.z.ai">https://chat.z.ai</a> </p>
<p>提問:</p>
<p><span style="background-color: #ccffcc;">請說明機械設計相關科系的大二學生該如何學習「電腦輔助設計與實習」課程，並透過虛實整合，驗證機電資控制系統的可行性?</span></p>
<p style="padding-left: 30px;">請就此一主題，建議學習步驟，並列出學生身分可以免費使用的工具。</p>
<p style="padding-left: 30px;">請就此一主題提供 15 則可以深入取得具體答覆的 AI 系統詢問句</p>
<p style="padding-left: 60px;">1. 請詳細說明大二學生在學習 Fusion 360 進行機械零件參數化建模時，應該掌握的核心技能有哪些？<br/>2. 如何利用 Onshape 教育版進行團隊協作設計，並確保版本控制與設計一致性？<br/>3. 請列出 FreeCAD 中適合初學者進行機械運動學模擬的模組及使用步驟。<br/>4. 在機械設計課程中，使用 Fusion 360 的 Motion Study 功能進行連桿機構運動模擬，該如何設定拘束條件？<br/>5. 請解釋 Webots 如何整合機械模型與控制程式，並用具體範例說明 PID 控制在其中的應用。<br/>6. 如何用 Tinkercad Circuits 模擬一個包含光電感測器與伺服馬達的簡易自動門控制系統？<br/>7. 請比較 Scilab Xcos 與 MATLAB Simulink 在控制系統模擬上的優缺點，特別針對機電系統設計。<br/>8. 學生如何利用 Wokwi Arduino 模擬環境有效測試多感測器控制系統的穩定性與反應速度？<br/>9. 請提供一個完整的機電系統設計專案案例，從 CAD 建模到控制系統模擬，再到 Webots 虛擬測試。<br/>10. 針對學生免費使用的軟體資源，如何設計一套循序漸進的學習計畫，有效結合機械設計與控制系統？<br/>11. 如何使用 Fusion 360 與 Simscale 整合進行結構強度與熱傳模擬，以驗證機械設計的可靠性？<br/>12. 請詳細說明 Arduino IDE 與 PlatformIO 開發環境在控制系統軟體撰寫上的差異與選擇建議。<br/>13. Webots 中如何設定真實物理參數（如摩擦力、慣性矩）來提升機器人運動模擬的準確度？<br/>14. 學生若無法取得實體機器人硬體，如何利用虛擬模擬工具達成機電系統整合的實作學習？<br/>15. 請介紹目前最適合機械設計系學生免費取得的線上課程或教學平台，針對 CAD 與機電整合控制系統教學。</p><h1>Topics</h1>
<p>電腦輔助設計室電腦硬體與網路使用介紹</p>
<p style="padding-left: 30px;">C 槽硬碟為 SSD，網路協定可以自行決定使用 IPv4 或 IPv6 (若使用純 IPv6 則必須設定 Proxy 才能連結到 github.com 以及僅支援 IPv4 協定的網站) </p>
<p>Teams 線上教學:</p>
<p style="padding-left: 30px;">以 "學號@nfu.edu.tw" 登入<span> </span><a href="https://login.microsoftonline.com/">https://login.microsoftonline.com/</a><span> </span>Office 365</p>
<p style="padding-left: 30px;">Teams 團隊代碼: wpv2s7j</p>
<p>下載可攜程式套件:</p>
<p style="padding-left: 30px;"><a href="http://229.cycu.org/portable_2026.7z">portable_2026.7z</a> (387MB)</p>
<p style="padding-left: 60px;">解開壓縮後，雙點擊 start_miniconda3.bat 啟動可攜系統，雙點擊 stop.bat 關閉可攜系統。</p>
<p style="padding-left: 60px;">可攜系統啟動後，在命令列執行 conda activate y:\envs\cmsimde 可進入能執行 CMSiMDE 的環境。</p>
<p style="padding-left: 60px;">若希望可攜系統啟動直接進入 cmsimde 環境，可將 start_miniconda3.bat 檔案中第 98 行: call "%CONDA_ROOT%\Scripts\activate.bat" %ENV_NAME% 更換為 call "%CONDA_ROOT%\Scripts\activate.bat" %Disk%:\envs\cmsimde。</p>
<p style="padding-left: 30px;"><a href="http://229.cycu.org/cad_data.7z">cad_data.7z</a> (包括 NX2312、Blender4.2 與 Webots2023b，4.2GB)</p>
<p style="padding-left: 60px;">解開壓縮檔，將 nx、Webots_2023b 與 Blender 4.2 等目錄放入可攜系統的 data 目錄中。</p>
<p style="padding-left: 60px;">在命令列執行 webotsw 可啟動 Webots，設定 NX 使用授權後，執行 ugraf -nx 可啟動 NX2312。</p>
<p style="padding-left: 60px;">Webots2023b 啟動時需要 openssl_lh_set_thunks 函式，因為這是特別的 OpenSSL 介接，其目的可能是透過此函式與 OpenSSL 整合記憶體分配、除錯、或 OpenSSL 引擎擴充。</p>
<p style="padding-left: 60px;">目前已知 miniconda 中必須透過 conda install openssl=3.0.16 安裝舊版後的 openssl-3-x64.dll 中才會包含openssl_lh_set_thunks 函式。</p>
<p style="padding-left: 30px;"><a href="https://learn.microsoft.com/zh-tw/cpp/windows/latest-supported-vc-redist?view=msvc-170">Microsoft Visual C++ 可轉散發套件</a> (<a href="https://drive.google.com/file/d/10dzQbk_OT1Cm354rnk-2_sXwRRUmDrjK/view?usp=drive_link">VC_redist.x64.exe</a>)</p>
<p>1. 複習如何開啟可攜套件、關閉可攜套件</p>
<p style="padding-left: 30px;">尚未有 Github 帳號者，必須自行<a href="https://docs.github.com/zh/get-started/start-your-journey/creating-an-account-on-github">建立 Github 帳號</a></p>
<p style="padding-left: 30px;">利用 Python 執行設計運算、組立件分割、控制機電系統並維護倉儲與網站內容</p>
<p style="padding-left: 60px;"><a href="/downloads/youbot_cart.7z">youbot_cart.7z</a></p>
<p style="padding-left: 90px;">命令列中執行 webotsw 啟動 Webots</p>
<p style="padding-left: 90px;">開啟 worlds 目錄中的 youbot_cart.wbt (執行控制程式後，以方向鍵控制 cart 移動)</p>
<p style="padding-left: 90px;">開啟 worlds 目錄中的 youbot_cart_w_shooter.wbt (按 a 送球，按 m 擊球，按 k 退回)</p>
<p style="padding-left: 30px;">說明如何建立分組倉儲 Template</p>
<p>2. 如何開啟 Solvespace、NX2312、Webots 與 Blender</p>
<p style="padding-left: 30px;">利用 Solvespace、NX2312 或 Onshape 進行零組件繪圖</p>
<p style="padding-left: 60px;"><a href="https://solvespace.com/tutorial.pl">Solvespace Tutorial</a></p>
<p style="padding-left: 90px;"><a href="https://youtu.be/vBNAIMiomls">Learn Solvespace</a></p>
<p style="padding-left: 60px;"><a href="https://www.youtube.com/playlist?list=PLA2s9EGiTDWBuUE55TRoueZdhaFWxWSl4">NX2312 Tutorial</a></p>
<p style="padding-left: 60px;"><a href="https://www.onshape.com/en/education/">Onshape for Education</a></p>
<p style="padding-left: 30px;">利用 Webots 建立機電模擬系統 (<a href="https://cyberbotics.com/doc/guide/index">User Guide</a>)</p>
<p style="padding-left: 60px;"><a href="https://cyberbotics.com/doc/guide/tutorials">Webots Tutorial</a></p>
<p style="padding-left: 30px;">利用 Blender 檢視組立件分割結果</p>
<p style="padding-left: 60px;"><a href="https://youtu.be/4haAdmHqGOw">Blender Tutorial</a></p>
<p>3. Github Classroom 上的分組網站: <a href="https://github.com/mdecad2025">https://github.com/mdecad2025</a> </p>
<p style="padding-left: 30px;">各組組長建立 Github Classroom 分組團隊，取得分組倉儲 </p>
<p>4. 利用 Git 與 Github 進行協同設計</p>
<p style="padding-left: 30px;">各組員維護分組倉儲中的分支，進行協同設計</p>
<p style="padding-left: 30px;">熟悉 Pull Requests 或各組員開發分支與主分支的合併</p>
<p>5. 平面五連桿機構零組件繪圖</p>
<p style="padding-left: 30px;">Solvespace、NX2312 與 Onshape 的操作應用</p>
<p>6. Webots 五連桿機構系統模擬</p>
<p style="padding-left: 30px;">零組件的 STL 與 OBJ 格式轉檔</p>
<p style="padding-left: 30px;">Blender 的零組件檢視應用</p>
<p style="padding-left: 30px;">Robot、Solid、Shape、CadShape、HingeJoint 與 device 節點的應用</p>
<p style="padding-left: 30px;">Python Controller 程式的應用</p>
<p>參考: </p>
<p style="padding-left: 30px;"><a href="http://wcm.cycu.org:88/github/cad2024/content/CAD.html">http://wcm.cycu.org:88/github/cad2024/content/CAD.html</a> </p>
<p style="padding-left: 30px;"><a href="https://github.com/mdecycu/pymadcad">https://github.com/mdecycu/pymadcad</a> </p><h1>Homework</h1>
<p>HW1:</p>
<p style="padding-left: 30px;">利用 NX2312、<a href="https://www.onshape.com/en/">Onshape</a>、Solvespace 或自選 CAD 套件繪製五連桿機構零組件。</p>
<p style="padding-left: 60px;">參考資料: <a href="/downloads/plotter.7z">plotter.7z</a> (in Solvespace)</p>
<p>HW2:</p>
<p style="padding-left: 30px;">Webots 五連桿 plotter 機構模擬，可讀取任何 png 圖檔，利用 plotter 在其工作範圍完成外圍輪廓線條繪圖。</p>
<p style="padding-left: 30px;"><img alt="" height="300" src="/images/mickey_mouse_plot.gif" width="300"/></p>
<p style="padding-left: 60px;">參考資料: <a href="/downloads/plotter.7z">plotter.7z</a> (in Solvespace)</p>
<p style="padding-left: 60px;"><img alt="" height="300" src="/images/5bar_simulation.gif" width="300"/></p>
<p style="padding-left: 60px;"><img caption="false" height="348" src="/images/fivebar_plotter.gif" width="500"/></p>
<p>HW3:</p>
<p style="padding-left: 30px;">五連桿 plotter 機電系統實作規劃。</p>
<p style="padding-left: 60px;">參考資料: <a href="/downloads/plotter.7z">plotter.7z</a> (in Solvespace)</p>
<p style="padding-left: 30px;"></p>
<p></p>
<p style="padding-left: 30px;"></p>
<p></p>
<h2>HW2</h2>
<p>一個五連桿平面機構，固定點 A 與 E 的座標分別為 (0, 0), (-50, 0), link1 從 A 點連接向 B 點長度, 為一個直角三角形的斜邊, 此三角形的長邊尺寸為 50, 短邊尺寸為 45, link2 從 B 點連接向 C 點, 長度為 110, link3 從 C 點連接向 D 點長度也是 110, 而最後 link4 從 D 點連接向 E 點 長度也是一個直角三角形的斜邊, 此三角形的長邊尺寸為 50, 短邊尺寸為 45。請問 link1 及 llink4 的長度分別為多少?<br/><br/>假設 A 點與 E 點分別裝設步進馬達, 其 A 點的旋轉角度是由其點右邊延伸水平線作為旋轉 0 度點，B 點起始點位於 X 軸上, 且旋轉方向為順時針方向, 而 E 點的旋轉角度則是由其點左邊延伸水平線作為旋轉 0 度點, D 點起始點也是位於 X 軸上, 且旋轉方向為逆時針方向旋轉, link1 的旋轉角度設為 theta1, 角度單位為 degree, 而 link4 的旋轉角度設為 theta2, 角度單位也是 degree, 請先利用此平面機構的兩個輸入角度作為函式的輸入變數, 用 link1 、link2、link3、link4 代表這四個連桿長度的符號名稱，且將此函數命名為 forward(theta1, theta2), 請利用正向運動學 (Forward Kinematics) 的方式，採符號運算法 (Symbolic Formulation)，利用 Python 的 sympy 模組, 讓 forward 函式的輸出為點 C 的 X 與 Y 座標。 請推導。 另外也請利用逆向運動學 (Inverse Kinematics) 的方式, 採符號運算法 (Symbolic Formulation)，利用 Python 的 sympy 模組, 讓 Inverse(C 點的 X 座標, C 點的 Y 座標) 函式的輸出為對應的 theta1 與 theta2 的轉角表示式。 請推導, 且各推導過程均列出機構各點的 floating point 座標點的位置.</p>
<p><a href="/downloads/fivebar_robot_2d.slvs">fivebar_robot_2d.slvs</a></p>
<p><img alt="" height="303" src="/images/fivebar_linkage_2d.png" width="300"/></p>
<p><!--StartFragment --></p>
<p>利用畢氏定理計算 link1 與 link4 的長度：</p>
<p>\[\sqrt{50^2 + 45^2} = \sqrt{2500 + 2025} = \sqrt{4525} \approx 67.27\]</p>
<p>因此定義如下:</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">import sympy as sp

L1 = L4 = sp.sqrt(45**2 + 50**2)  # ≈ 67.24
L2 = 110
L3 = 110</pre>
<p><!--StartFragment --></p>
<p>Forward Kinematics</p>
<p>目標是定義 forward(theta1, theta2) 輸出點 C 的 (x, y)。</p>
<p>幾何分析</p>
<ol>
<li>點 A 為原點 (0, 0)，link1 由 A 旋轉 \(\theta_1\) 延伸至點 B。</li>
<li>點 E 座標為 (-50, 0)，link4 由 E 旋轉 \(\theta_2\) 延伸至點 D。</li>
<li>B 與 D 透過兩段連桿（link2 與 link3）連接，經過點 C。</li>
</ol>
<p>先定義這些變數並推導 B、D、C 的位置。</p>
<p>forward 函式: <a href="/downloads/fivebar_forward.py">fivebar_forward.py</a></p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">import sympy as sp

# 正向運動學：給定角度與長度，求 C 點（兩個構型）
def forward(theta1_deg, theta2_deg, l1, l2, l3, l4):
    # 角度轉弧度，考慮旋轉方向
    theta1 = -theta1_deg * sp.pi / 180             # A 點，順時針
    theta2 = (180 + theta2_deg) * sp.pi / 180      # E 點，左水平方向起點，逆時針旋轉

    # 固定點座標
    Ax, Ay = 0, 0
    Ex, Ey = -50, 0

    # B, D 點位置
    Bx = Ax + l1 * sp.cos(theta1)
    By = Ay + l1 * sp.sin(theta1)
    Dx = Ex + l4 * sp.cos(theta2)
    Dy = Ey + l4 * sp.sin(theta2)

    # 向量 BD
    vec_x = Dx - Bx
    vec_y = Dy - By
    d = sp.sqrt(vec_x**2 + vec_y**2)

    # 中點 M
    Mx = (Bx + Dx) / 2
    My = (By + Dy) / 2

    # 高（從 M 垂直方向偏移）
    try:
        h = sp.sqrt(l2**2 - (d / 2)**2)
    except:
        raise ValueError("構型不可行：連桿無法形成三角形")

    # 單位向量 u = BD / ||BD||
    ux = vec_x / d
    uy = vec_y / d

    # 垂直向量（旋轉 90°）
    vx = -uy
    vy = ux

    # C 點 1（上構型）
    C1x = Mx + h * vx
    C1y = My + h * vy

    # C 點 2（下構型）
    C2x = Mx - h * vx
    C2y = My - h * vy

    print("B 點座標:", float(Bx.evalf()), float(By.evalf()))
    print("D 點座標:", float(Dx.evalf()), float(Dy.evalf()))
    print("C 點 1（上構型）:", float(C1x.evalf()), float(C1y.evalf()))
    print("C 點 2（下構型）:", float(C2x.evalf()), float(C2y.evalf()))

    return (float(C1x.evalf()), float(C1y.evalf())), (float(C2x.evalf()), float(C2y.evalf()))
    
print(forward(30, 45, 67.27, 110, 110, 67.27))</pre>
<p>Inverse Kinematics: <a href="/downloads/fivebar_inverse.py">fivebar_inverse.py</a></p>
<p>現在要從點 C 的座標反推出 \(\theta_1, \theta_2\)。這部分相當複雜，因為存在多組解，因此我們專注於符號推導步驟。</p>
<p>幾何觀念</p>
<ol>
<li>給定 C 點座標，要反推出：</li>
<li>B 點在以 A 為中心，半徑為 L1 的圓周上</li>
<li>D 點在以 E 為中心，半徑為 L4 的圓周上</li>
<li>B → C 與 D → C 分別長 L2, L3</li>
<li>使用向量反推、餘弦定理與 atan2 組合來求解旋轉角。</li>
</ol>
<p>Inverse Kinematics:</p>
<p><!--StartFragment --><!--EndFragment --></p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false"># 逆向運動學：輸入 C 點位置與桿長，反推所有可能的角度組合
import sympy as sp

def inverse(cx_val, cy_val, l1_val, l2_val, l3_val, l4_val):
    # 定義符號變數
    Cx, Cy, L1, L2, L3, L4 = sp.symbols('Cx Cy L1 L2 L3 L4', real=True)

    # 固定點 A 與 E
    Ax, Ay = 0, 0
    Ex, Ey = -50, 0

    # ========== θ₁（順時針，從 +X 起算） ==========
    vec_A = sp.Matrix([Cx - Ax, Cy - Ay])
    r1 = vec_A.norm()
    angle_A = sp.atan2(vec_A[1], vec_A[0])
    cos_alpha1 = (L1**2 + r1**2 - L2**2) / (2 * L1 * r1)
    cos_alpha1 = sp.Max(-1, sp.Min(1, cos_alpha1))  # 保護 acos 領域
    alpha1 = sp.acos(cos_alpha1)
    theta1_a = -sp.deg(angle_A - alpha1)
    theta1_b = -sp.deg(angle_A + alpha1)

    # ========== θ₂（逆時針，從 –X 起算） ==========
    vec_E = sp.Matrix([Cx - Ex, Cy - Ey])
    r2 = vec_E.norm()
    angle_E = sp.atan2(vec_E[1], vec_E[0])
    cos_alpha2 = (L4**2 + r2**2 - L3**2) / (2 * L4 * r2)
    cos_alpha2 = sp.Max(-1, sp.Min(1, cos_alpha2))  # 保護 acos 領域
    alpha2 = sp.acos(cos_alpha2)
    # 補回 forward 中的 +180°
    theta2_a = sp.deg(angle_E - alpha2) - 180
    theta2_b = sp.deg(angle_E + alpha2) - 180

    # 數值代入
    subs = {
        Cx: cx_val,
        Cy: cy_val,
        L1: l1_val,
        L2: l2_val,
        L3: l3_val,
        L4: l4_val
    }

    try:
        θ1a = float(theta1_a.evalf(subs=subs))
        θ1b = float(theta1_b.evalf(subs=subs))
        θ2a = float(theta2_a.evalf(subs=subs))
        θ2b = float(theta2_b.evalf(subs=subs))
    except Exception as e:
        return [f"發生錯誤：{e}"]
        
    def normalize(a):
        return round(a % 360, 4)


    # 組合所有可能構型角度
    results = [
        (normalize(θ1a), normalize(θ2a)),
        (normalize(θ1a), normalize(θ2b)),
        (normalize(θ1b), normalize(θ2a)),
        (normalize(θ1b), normalize(θ2b)),
    ]

    return results
    
print(inverse(-12.77, -117.63, 67.27, 110, 110, 67.27))</pre>
<p><br/><br/></p>
<p>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</p>
<h3>Plotter</h3>
<p dir="auto" style="white-space: pre-wrap;">To determine the drawable workspace of the five-bar linkage mechanism described in the provided Webots controller code and to outline it with a green contour, we need to compute the reachable workspace of the end-effector (point C) based on the kinematic constraints of the mechanism. Then, we will generate the outer and inner boundary contours and instruct the plotter to trace these contours. Below is the step-by-step solution.</p>
<hr/>
<h4 dir="auto">Step 1: Understanding the Five-Bar Linkage and Workspace</h4>
<p dir="auto" style="white-space: pre-wrap;">The five-bar linkage mechanism consists of two fixed points (A and E) and two actuated joints (θ1 and θ2) that control the positions of points B and D, respectively. Point C is the end-effector, determined by the intersection of two circles centered at B (radius L2) and D (radius L3). The mechanism parameters are:</p>
<ul dir="auto">
<li><strong>L1 = L4 = 0.1682 m</strong> (lengths of the first and fourth links)</li>
<li><strong>L2 = L3 = 0.275 m</strong> (lengths of the second and third links)</li>
<li><strong>A = [0.0625, 0.15] m</strong> (fixed pivot for θ1)</li>
<li><strong>E = [-0.0625, 0.15] m</strong> (fixed pivot for θ2)</li>
<li><strong>offset = 41.9872°</strong> (affects the angle calculations)</li>
</ul>
<p dir="auto" style="white-space: pre-wrap;">The workspace is the set of all possible positions of point C, constrained by the joint angles θ1 and θ2 (ranging from -180° to 180°) and the geometric constraints of the linkage. The workspace is typically an annulus-like region (a ring-shaped area) due to the fixed distances from A to B (L1), B to C (L2), E to D (L4), and D to C (L3).</p>
<h4 dir="auto">Step 2: Computing the Workspace Boundaries</h4>
<p dir="auto" style="white-space: pre-wrap;">To find the workspace, we need to determine the outer and inner boundaries of the region where point C can exist. This involves:</p>
<ul dir="auto">
<li><strong>Outer boundary</strong>: The maximum extent of point C when the linkage is fully extended.</li>
<li><strong>Inner boundary</strong>: The minimum extent when the linkage is folded inward, subject to valid kinematic solutions.</li>
</ul>
<p dir="auto" style="white-space: pre-wrap;">The workspace can be approximated by sampling the joint angles θ1 and θ2 over their range and computing the corresponding positions of point C using the forward kinematics function. The boundaries are traced by finding the extreme points (maximum and minimum radial distances from a reference point, e.g., the origin or the midpoint between A and E).</p>
<h4 dir="auto">Forward Kinematics Recap</h4>
<p dir="auto" style="white-space: pre-wrap;">The <span>forward_kinematics(theta1_rad, theta2_rad)</span> function computes point C as follows:</p>
<ol dir="auto">
<li><strong>Point B</strong>: <span>B = A + L1 * [cos(θ1 + offset), -sin(θ1 + offset)]</span></li>
<li><strong>Point D</strong>: <span>D = E - L4 * [cos(θ2 + offset), sin(θ2 + offset)]</span></li>
<li><strong>Point C</strong>: The intersection of a circle centered at B with radius L2 and a circle centered at D with radius L3. The function selects the intersection with the smaller y-coordinate (elbow-down configuration).</li>
</ol>
<h4 dir="auto">Workspace Boundary Calculation</h4>
<p dir="auto" style="white-space: pre-wrap;">To trace the workspace boundaries:</p>
<ul dir="auto">
<li><strong>Outer boundary</strong>: Occurs when the linkage is fully extended, e.g., when B and C are aligned such that the distance from A to C is maximized (approximately L1 + L2 = 0.1682 + 0.275 = 0.4432 m).</li>
<li><strong>Inner boundary</strong>: Occurs when the linkage is folded, and the distance from A to C is minimized, subject to valid intersections between the circles at B and D.</li>
</ul>
<p dir="auto" style="white-space: pre-wrap;">We can sample θ1 and θ2 over [-180°, 180°] with a fine grid (e.g., 360 points per angle) to compute all possible C points. The convex hull of these points approximates the outer boundary, while the inner boundary requires identifying configurations where the distance from a reference point (e.g., the origin) is minimized, often when the linkage is folded inward.</p>
<p dir="auto" style="white-space: pre-wrap;">To simplify, we assume the workspace is symmetric around the line connecting A and E (y = 0.15 m) due to the symmetry in L1 = L4 and L2 = L3. We compute the workspace by:</p>
<ol dir="auto">
<li>Sampling θ1 and θ2 in increments (e.g., 5°).</li>
<li>Computing C for each (θ1, θ2) pair using <span>forward_kinematics</span>.</li>
<li>Collecting valid C points (where intersections exist).</li>
<li>Determining the outer and inner boundaries by finding the maximum and minimum radial distances from a reference point (e.g., the origin [0, 0]) for each angular direction.</li>
</ol>
<h4 dir="auto">Step 3: Generating the Workspace Contours</h4>
<p dir="auto" style="white-space: pre-wrap;">To generate the outer and inner contours:</p>
<ul dir="auto">
<li><strong>Outer contour</strong>: For each angle φ around the origin (0, 0), find the C point with the maximum radial distance |C| = sqrt(x² + y²).</li>
<li><strong>Inner contour</strong>: For each angle φ, find the C point with the minimum radial distance, ensuring valid kinematic solutions.</li>
</ul>
<p dir="auto" style="white-space: pre-wrap;">The algorithm to compute the contours is as follows:</p>
<ol dir="auto">
<li>Define a range of angles φ (0 to 360°, e.g., 360 points).</li>
<li>For each φ, iterate over a grid of θ1 and θ2 values (e.g., 72 points each, 5° increments).</li>
<li>Compute C for each (θ1, θ2) using <span>forward_kinematics</span>.</li>
<li>Calculate the radial distance |C| and the angle of C relative to the origin.</li>
<li>Group C points by their angle φ (within a small tolerance, e.g., ±2.5°).</li>
<li>Select the maximum (outer) and minimum (inner) |C| for each φ bin.</li>
<li>Sort the points by φ to create smooth contours.</li>
</ol>
<h4 dir="auto">Step 4: Plotting the Contours in Webots</h4>
<p dir="auto" style="white-space: pre-wrap;">The provided code already includes a mechanism to draw a green line in Webots using an <span>IndexedLineSet</span>. We will modify this to draw two separate contours (outer and inner) in green, ensuring they are closed loops if the workspace is continuous.</p>
<h4 dir="auto">Step 5: Sweeping the Contours with the Plotter</h4>
<p dir="auto" style="white-space: pre-wrap;">To make the plotter trace the outer and inner contours:</p>
<ol dir="auto">
<li>Use the <span>inverse_kinematics</span> function to compute (θ1, θ2) for each point on the outer and inner contours.</li>
<li>Apply the same interpolation and control logic as in the original code to move the plotter along each contour sequentially.</li>
<li>Ensure smooth transitions between points using linear interpolation in joint space, as done in the original code.</li>
</ol>
<h4 dir="auto">Implementation</h4>
<p dir="auto" style="white-space: pre-wrap;">Below is the modified code to compute the workspace boundaries, draw the green contours, and control the plotter to trace both contours. This code extends the original by adding workspace computation and contour tracing.</p>
<h1>Network</h1>
<p>這裡所指的 Network 是 Computer Network，電腦網路可說是目前電腦輔助設計流程的基礎設施，許多輔助設計的軟體透過電腦網路執行認證、協同設計或及時擷取資源。因此進行電腦輔助設計流程之前，必須對所依附使用的電腦網路系統與架構有所了解。</p>
<p><a href="https://en.wikipedia.org/wiki/Computer_network">Computer Network</a>:</p>
<p>A<span> </span><b>computer network</b><span> </span>is a collection of communicating<span> </span><a href="https://en.wikipedia.org/wiki/Computer" title="Computer">computers</a><span> </span>and other devices, such as printers and smart phones. In order to communicate, the computers and devices must be connected by wired media like copper cables,<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Optical_fibers" title="Optical fibers">optical fibers</a>, or by<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Wireless_communication" title="Wireless communication">wireless communication</a>. The devices may be connected in a variety of<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Network_topologies" title="Network topologies">network topologies</a>. In order to communicate over the network, computers use agreed-on rules, called<span> </span><a href="https://en.wikipedia.org/wiki/Communication_protocol" title="Communication protocol">communication protocols</a>, over whatever medium is used.</p>
<p>The computer network can include<span> </span><a href="https://en.wikipedia.org/wiki/Personal_computer" title="Personal computer">personal computers</a>,<span> </span><a href="https://en.wikipedia.org/wiki/Server_(computing)" title="Server (computing)">servers</a>,<span> </span><a href="https://en.wikipedia.org/wiki/Networking_hardware" title="Networking hardware">networking hardware</a>, or other specialized or general-purpose<span> </span><a href="https://en.wikipedia.org/wiki/Host_(network)" title="Host (network)">hosts</a>. They are identified by<span> </span><a href="https://en.wikipedia.org/wiki/Network_address" title="">network addresses</a><span> </span>and may have<span> </span><a href="https://en.wikipedia.org/wiki/Hostname" title="Hostname">hostnames</a>. Hostnames serve as memorable labels for the nodes and are rarely changed after initial assignment. Network addresses serve for locating and identifying the nodes by communication protocols such as the<span> </span><a href="https://en.wikipedia.org/wiki/Internet_Protocol" title="Internet Protocol">Internet Protocol</a>.</p>
<p></p>
<h2>IPv6</h2>
<p>IPv6 網路協定是用來解決 IPv4 網路不敷使用的問題而產生。但是目前許多伺服器尚未全面支援 IPv6 網路協定，其原因很多，其中包括使用者欠缺對於 IPv6 網路協定的認識，或者因為伺服器上的用戶程式並未做好支援 IPv6 的準備。無論如何當決定在電腦輔助設計流程使用 IPv6 網路協定後，必須設法因應各種問題，讓採純 IPv6 網路協定設計的環境能夠連線至各個伺服器。</p>
<p><a href="https://en.wikipedia.org/wiki/IPv6">IPv6</a>: </p>
<p><b>Internet Protocol version 6</b><span><span> </span>(</span><b>IPv6</b><span>) is the most recent version of the<span> </span></span><a href="https://en.wikipedia.org/wiki/Internet_Protocol" title="Internet Protocol">Internet Protocol</a><span><span> </span>(IP), the<span> </span></span><a href="https://en.wikipedia.org/wiki/Communication_protocol" title="Communication protocol">communications protocol</a><span><span> </span>that provides an identification and location system for computers on networks and routes traffic across the<span> </span></span><a href="https://en.wikipedia.org/wiki/Internet" title="Internet">Internet</a><span>. IPv6 was developed by the<span> </span></span><a href="https://en.wikipedia.org/wiki/Internet_Engineering_Task_Force" title="Internet Engineering Task Force">Internet Engineering Task Force</a><span><span> </span>(IETF) to deal with the long-anticipated problem of<span> </span></span><a href="https://en.wikipedia.org/wiki/IPv4_address_exhaustion" title="IPv4 address exhaustion">IPv4 address exhaustion</a><span>, and was intended to replace<span> </span></span><a href="https://en.wikipedia.org/wiki/IPv4" title="IPv4">IPv4</a><span>.</span><span><span> </span>In December 1998, IPv6 became a Draft Standard for the IETF,</span><span><span> </span>which subsequently ratified it as an<span> </span></span><a href="https://en.wikipedia.org/wiki/Internet_Standard" title="Internet Standard">Internet Standard</a><span><span> </span>on 14 July 2017.</span></p>
<h2>DNS</h2>
<p>DNS 指的是 <a href="https://en.wikipedia.org/wiki/Domain_Name_System">Domain Name System</a>:</p>
<p><span>The </span><b>Domain Name System</b><span><span> </span>(</span><b>DNS</b><span>) is a hierarchical and distributed<span> </span></span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Name_service" title="Name service">name service</a><span><span> </span>that provides a naming system for<span> </span></span><a href="https://en.wikipedia.org/wiki/Computer" title="Computer">computers</a><span>, services, and other resources on the Internet or other<span> </span></span><a href="https://en.wikipedia.org/wiki/Internet_Protocol" title="Internet Protocol">Internet Protocol</a><span><span> </span>(IP) networks. It associates various information with<span> </span></span><i><a href="https://en.wikipedia.org/wiki/Domain_name" title="">domain names</a></i><span><span> </span>(</span><a href="https://en.wikipedia.org/wiki/Identification_(information)" title="Identification (information)">identification</a><span><span> </span></span><a href="https://en.wikipedia.org/wiki/String_(computer_science)" title="String (computer science)">strings</a><span>) assigned to each of the associated entities. Most prominently, it translates readily memorized domain names to the numerical<span> </span></span><a href="https://en.wikipedia.org/wiki/IP_address" title="IP address">IP addresses</a><span><span> </span>needed for locating and identifying computer services and devices with the underlying<span> </span></span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Network_protocol" title="Network protocol">network protocols</a><span>.</span><sup class="reference" id="cite_ref-1"><a href="https://en.wikipedia.org/wiki/Domain_Name_System#cite_note-1"><span class="cite-bracket">[</span>1<span class="cite-bracket">]</span></a></sup><span><span> </span>The Domain Name System has been an essential component of the functionality of the Internet since 1985.</span></p>
<h2>Proxy</h2>
<h2>Web</h2>
<h3>Codespaces</h3>
<p><a href="https://github.com/codespaces">https://github.com/codespaces</a> </p>
<h1>Software</h1>
<p>這裡的 Software 指的是電腦軟體，執行電腦輔助設計時會接觸電腦操作系統、電腦輔助設計套件以及全球資訊網相關的各種應用軟體。</p>
<p><a href="https://en.wikipedia.org/wiki/Software">Software</a>:</p>
<p>The history of software is closely tied to the development of digital computers in the mid-20th century. Early programs were written in the<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Machine_language" title="Machine language">machine language</a><span> </span>specific to the hardware. The introduction of<span> </span><a href="https://en.wikipedia.org/wiki/High-level_programming_language" title="">high-level programming languages</a><span> </span>in 1958 allowed for more human-readable instructions, making<span> </span><a href="https://en.wikipedia.org/wiki/Software_development" title="Software development">software development</a><span> </span>easier and more portable across different<span> </span><a href="https://en.wikipedia.org/wiki/Computer_architecture" title="Computer architecture">computer architectures</a>. Software in a programming language is run through a<span> </span><a href="https://en.wikipedia.org/wiki/Compiler" title="Compiler">compiler</a><span> </span>or<span> </span><a href="https://en.wikipedia.org/wiki/Interpreter_(computing)" title="Interpreter (computing)">interpreter</a><span> </span>to<span> </span><a href="https://en.wikipedia.org/wiki/Execution_(computing)" title="Execution (computing)">execute</a><span> </span>on the architecture's hardware. Over time, software has become complex, owing to developments in<span> </span><a href="https://en.wikipedia.org/wiki/Computer_network" title="Computer network">networking</a>,<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Operating_systems" title="Operating systems">operating systems</a>, and<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Databases" title="Databases">databases</a>.</p>
<p>Software can generally be categorized into two main types:</p>
<ol>
<li><a href="https://en.wikipedia.org/wiki/Operating_system" title="Operating system">operating systems</a>, which manage hardware resources and provide services for applications</li>
<li><a href="https://en.wikipedia.org/wiki/Application_software" title="Application software">application software</a>, which performs specific tasks for users</li>
</ol>
<p>The rise of<span> </span><a href="https://en.wikipedia.org/wiki/Cloud_computing" title="Cloud computing">cloud computing</a><span> </span>has introduced the new software delivery model<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Software_as_a_Service" title="Software as a Service">Software as a Service</a><span> </span>(SaaS). In SaaS, applications are hosted by a<span> </span><a href="https://en.wikipedia.org/wiki/Application_service_provider" title="Application service provider">provider</a><span> </span>and<span> </span><a href="https://en.wikipedia.org/wiki/HTTP" title="HTTP">accessed</a><span> </span>over the<span> </span><a href="https://en.wikipedia.org/wiki/Internet" title="Internet">Internet</a>.</p>
<p>The process of developing software involves several stages. The stages include<span> </span><a href="https://en.wikipedia.org/wiki/Software_design" title="Software design">software design</a>,<span> </span><a href="https://en.wikipedia.org/wiki/Computer_programming" title="Computer programming">programming</a>,<span> </span><a href="https://en.wikipedia.org/wiki/Software_testing" title="Software testing">testing</a>,<span> </span><a href="https://en.wikipedia.org/wiki/Software_release_life_cycle" title="Software release life cycle">release</a>, and<span> </span><a href="https://en.wikipedia.org/wiki/Software_maintenance" title="Software maintenance">maintenance</a>.<span> </span><a href="https://en.wikipedia.org/wiki/Software_quality_assurance" title="Software quality assurance">Software quality assurance</a><span> </span>and<span> </span><a href="https://en.wikipedia.org/wiki/Information_security" title="Information security">security</a><span> </span>are critical aspects of software development, as<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Computer_bug" title="Computer bug">bugs</a><span> </span>and<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Vulnerability_(computing)" title="Vulnerability (computing)">security vulnerabilities</a><span> </span>can lead to system failures and security breaches. Additionally, legal issues such as software licenses and intellectual property rights play a significant role in the distribution of software products.</p>
<p></p>
<h2>Git</h2>
<p>Git and Github</p>
<p>電腦輔助機械設計流程:</p>
<p style="padding-left: 30px;">每六位學員一組，請自選套件協同完成平面<a href="https://en.wikipedia.org/wiki/Four-bar_linkage">四連桿機構</a>的零組件設計繪圖。完成後請詳細說明設計與繪圖過程。</p>
<h2>CMSiMDE</h2>
<p>可攜 Python 程式環境，使用 miniconda3:</p>
<p style="padding-left: 30px;">Miniconda is a free, miniature installation of Anaconda Distribution that includes only conda, Python, the packages they both depend on, and a small number of other useful packages.<br/><br/>If you need more packages, use the conda install command to install from thousands of packages available by default in Anaconda’s public repo, or from other channels, like conda-forge or bioconda.</p>
<p style="padding-left: 30px;">授權方式    BSD 3-Clause License（自由軟體）<br/>是否開源    是（可以查閱與修改原始碼）<br/>是否免費    是（個人與商業皆免費使用）<br/>用途限制    無限制，可用於學術、商業、開發、產品部署等<br/>提供單位    Anaconda, Inc.</p>
<p style="padding-left: 30px;">官方網站: <a href="https://www.anaconda.com/download/success">https://www.anaconda.com/download/success</a> </p>
<p style="padding-left: 30px;"><a href="https://drive.google.com/file/d/1ozhZ2U8Ei1ctKklnC589Xs1ouCHnqgTa/view?usp=drive_link">miniconda3.7z</a></p>
<p style="padding-left: 60px;"><a href="/downloads/start_miniconda3_bat.txt">start_miniconda3_bat.txt</a></p>
<p style="padding-left: 60px;">啟動 miniconda3 虛擬環境後，在命令列中執行下列批次檔案，可以導入 NX2312 與 Webots 所需的 Python 模組目錄設定。</p>
<p style="padding-left: 90px;"><a href="/downloads/add_nx_webots_pythonpath_bat.txt">add_nx_webots_pythonpath_bat.txt</a></p>
<p style="padding-left: 30px;">check python path: python -c "import sys; print(sys.executable)"</p>
<p>啟動後 Python 環境位於 base，利用下列指令建立 cmsimde 虛擬環境:</p>
<p style="padding-left: 30px;">conda create -p ./envs/cmsimde python=3.13</p>
<p style="padding-left: 30px;">conda activate y:\envs\cmsimde</p>
<p style="padding-left: 30px;">conda install -c conda-forge flask flask_cors bs4 lxml pelican markdown gevent</p>
<p style="padding-left: 30px;">之後就可以 cd tmp/your_hw_repository 後，以 cms 啟動網頁編輯。</p>
<h3>Flask</h3>
<h2>Solvespace</h2>
<p>Solvespace: <a href="https://solvespace.com">https://solvespace.com</a></p>
<p><a href="/downloads/Jansen_whitworth_mechanism.7z">Jansen_whitworth_mechanism.7z</a></p>
<p><a href="https://github.com/mdecycu/WalkerBot-MakerKit">https://github.com/mdecycu/WalkerBot-MakerKit</a> </p>
<h3>Compile</h3>
<h2>NX2312</h2>
<p>這裡將使用電腦輔助設計室所安裝的 NX2312 套件.</p>
<p>Siemens NX: <a href="https://plm.sw.siemens.com/en-US/nx/">https://plm.sw.siemens.com/en-US/nx/</a></p>
<p style="padding-left: 30px;"><a href="https://docs.sw.siemens.com/en-US/documents/209349590/PL20230425446868577">NX2312 Documentation</a></p>
<p>NXOpen: <a href="https://github.com/mdecycu/nxopen">https://github.com/mdecycu/nxopen</a></p>
<p style="padding-left: 30px;"><a href="https://docs.sw.siemens.com/en-US/doc/209349590/PL20230425446868577.nxopen_prog_guide/xid2250951">Setup NXOpen Python Intellisense</a></p>
<p>在自己的電腦上，以可攜方式執行 NX2312:</p>
<p style="padding-left: 30px;"><a href="http://229.cycu.org/portable_2026.7z">portable_2026.7z</a> (387MB)</p>
<p style="padding-left: 60px;">解開壓縮後，雙點擊 start_miniconda3.bat 啟動可攜系統，雙點擊 stop.bat 關閉可攜系統。</p>
<p style="padding-left: 60px;">可攜系統啟動後，在命令列執行 conda activate y:\envs\cmsimde 可進入能執行 CMSiMDE 的環境。</p>
<p style="padding-left: 60px;">若希望可攜系統啟動直接進入 cmsimde 環境，可將 start_miniconda3.bat 檔案中第 98 行: call "%CONDA_ROOT%\Scripts\activate.bat" %ENV_NAME% 更換為 call "%CONDA_ROOT%\Scripts\activate.bat" %Disk%:\envs\cmsimde。</p>
<p style="padding-left: 30px;"><a href="http://229.cycu.org/cad_data.7z">cad_data.7z</a> (包括 NX2312、Blender4.2 與 Webots2023b，4.2GB)</p>
<p style="padding-left: 60px;">解開壓縮檔，將 nx、Webots_2023b 與 Blender 4.2 等目錄放入可攜系統的 data 目錄中。</p>
<p style="padding-left: 60px;">在命令列執行 webotsw 可啟動 Webots，設定 NX 使用授權後，執行 ugraf -nx 可啟動 NX2312。</p>
<p style="padding-left: 60px;">Webots2023b 啟動時需要 openssl_lh_set_thunks 函式，因為這是特別的 OpenSSL 介接，其目的可能是透過此函式與 OpenSSL 整合記憶體分配、除錯、或 OpenSSL 引擎擴充。</p>
<p style="padding-left: 60px;">目前已知 miniconda 中必須透過 conda install openssl=3.0.16 安裝舊版後的 openssl-3-x64.dll 中才會包含openssl_lh_set_thunks 函式。</p>
<p style="padding-left: 30px;"><a href="https://learn.microsoft.com/zh-tw/cpp/windows/latest-supported-vc-redist?view=msvc-170">Microsoft Visual C++ 可轉散發套件</a> (<a href="https://drive.google.com/file/d/10dzQbk_OT1Cm354rnk-2_sXwRRUmDrjK/view?usp=drive_link">VC_redist.x64.exe</a>)</p>
<p>在電腦輔助設計室中，利用可攜套件設定，執行安裝於 C: 中的 NX2312:</p>
<p style="padding-left: 30px;">修改 start_miniconda3.bat，將可攜套件 NX 路徑換成 C: 中安裝 NX2312 所在路徑後，將批次檔案存為 start_cadlab_nx.bat</p>
<p>NX2312 NXOpen Python 動態連結程式庫版本: Python 3.10.9</p>
<p style="padding-left: 30px;">在可攜程式環境中利用 miniconda3 建立 nxopen 虛擬環境 (注意: 必須使用反斜線分隔目錄名稱):</p>
<p style="padding-left: 60px;"><span style="background-color: #ccffcc;">conda create -p y:\envs\nxopen python=3.10</span> 指定建立 nxopen Python 環境，並使用 3.10 版。</p>
<p style="padding-left: 60px;"><span style="background-color: #ccffcc;">conda activate y:\envs\nxopen</span> 將 Python 環境切換到 nxopen env。</p>
<p style="padding-left: 60px;"><span style="background-color: #ccffcc;">where python</span> 查詢目前 env 所使用的 Python 所在目錄位置。</p>
<p style="padding-left: 60px;"><span style="background-color: #ccffcc;">conda clean --all</span> 刪除安裝 env 時所下載的安裝套件以及暫存檔案。</p>
<p style="padding-left: 60px;">進入 nxopen 虛擬環境後，在命令列執行下列 PYTHONPATH 設定，可以使用 Python </p>
<p style="padding-left: 60px;"><a href="/downloads/add_nx_webots_pythonpath_bat.txt">add_nx_webots_pythonpath_bat.txt</a></p>
<p style="padding-left: 60px;">若要在 SciTE 編輯器中指令使用 nxopen env 中的 Python，可以先在命令列中以 conda activate nxopen 後，接著以 where python 查詢所使用 python.exe 所在目錄後，利用處於同樣目錄的 pythonw.exe 設定 python.properties:</p>
<p style="padding-left: 90px;">if PLAT_WIN<br/>    python.command=y:\envs\nxopen\python.exe</p>
<p style="padding-left: 60px;">完成 python.properties 設定修改後，在命令列中利用 start /MIN y:\wscite\SciTE.exe  開啟編輯器後，以下列程式查詢所使用的 conda env，以及所使用的 Python 版本:</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">import sys
import os

conda_env = os.environ.get("CONDA_DEFAULT_ENV")
print(f"Conda env：{conda_env}")
print(f"Python version: {sys.version}")</pre>
<p style="padding-left: 60px;"></p>
<h3>License</h3>
<p>在電腦輔助設計過程使用電腦套件時，必須明確了解該套件的使用授權。本課程所使用的 <a href="https://github.com/mdecycu/cmsimde">CMSiME </a>為 <a href="https://github.com/mdecycu/cmsimde/blob/master/LICENSE">GNU Affero General Public License v3.0</a>，而 Siemens NX 除了一般教育單位購買的授權外，也提供<a href="https://plm.sw.siemens.com/en-US/nx/student-software/">學生使用授權</a>。</p>
<p>Siemens NX 使用了很多開源軟體，其使用授權: <a href="https://download.industrysoftware.automation.siemens.com/open-source/">https://download.industrysoftware.automation.siemens.com/open-source/</a> </p>
<p>教育單位使用 Siemens NX 的使用授權: <a href="https://docs.sw.siemens.com/en-US/doc/209349590/PL20230425446868577.xid1851843/topicSet_copyright">NX2312 版權宣告</a></p>
<p>License Server (認證伺服器)</p>
<p><a href="https://support.sdasoftware.com/portal/en/kb/articles/siemens-license-server-installation-and-setup">https://support.sdasoftware.com/portal/en/kb/articles/siemens-license-server-installation-and-setup</a> </p>
<p>NX2212 之後的認證伺服器變更: <a href="https://support.sw.siemens.com/en-US/okba/PL8687318/NX-2212-licensing-changes-Mandatory-use-of-Siemens-License-Server/index.html">https://support.sw.siemens.com/en-US/okba/PL8687318/NX-2212-licensing-changes-Mandatory-use-of-Siemens-License-Server/index.html</a> </p>
<p>一旦全面 SaaS 化之後的 Siemens Nx，客戶端的使用認證將不再依賴近端的認證伺服器。</p>
<p style="padding-left: 30px;">SaaS 之後的 Siemens NX X: <a href="https://resources.sw.siemens.com/en-US/video-introducing-nx-x-nx-as-a-saas-solution/">https://resources.sw.siemens.com/en-US/video-introducing-nx-x-nx-as-a-saas-solution/</a> </p>
<h2>Onshape</h2>
<p>OnShape: <a href="https://www.onshape.com/en/">https://www.onshape.com/en/</a></p>
<h2>Webots</h2>
<p><a href="https://cyberbotics.com/">https://cyberbotics.com/</a></p>
<p><a href="https://www.slideshare.net/slideshow/tpwebots7mai2021pdf/259157378">https://www.slideshare.net/slideshow/tpwebots7mai2021pdf/259157378</a> </p>
<p><a href="https://introduction-to-autonomous-robots.github.io/lab-manipulation-introduction.html">https://introduction-to-autonomous-robots.github.io/lab-manipulation-introduction.html</a> </p>
<p><a href="https://www.instructables.com/Vacuum-Cleaner-Robot-in-Webots/">https://www.instructables.com/Vacuum-Cleaner-Robot-in-Webots/</a> </p>
<p><a href="https://www.eecs.ucf.edu/cssd/fall13/ucfsr/files/FinalDoc.pdf">https://www.eecs.ucf.edu/cssd/fall13/ucfsr/files/FinalDoc.pdf</a> </p>
<p>在自己的電腦上，以可攜方式執行 Webots:</p>
<p style="padding-left: 30px;"><a href="http://229.cycu.org/portable_2026.7z">portable_2026.7z</a> (387MB)</p>
<p style="padding-left: 60px;">解開壓縮後，雙點擊 start_miniconda3.bat 啟動可攜系統，雙點擊 stop.bat 關閉可攜系統。</p>
<p style="padding-left: 60px;">可攜系統啟動後，在命令列執行 conda activate y:\envs\cmsimde 可進入能執行 CMSiMDE 的環境。</p>
<p style="padding-left: 60px;">若希望可攜系統啟動直接進入 cmsimde 環境，可將 start_miniconda3.bat 檔案中第 98 行: call "%CONDA_ROOT%\Scripts\activate.bat" %ENV_NAME% 更換為 call "%CONDA_ROOT%\Scripts\activate.bat" %Disk%:\envs\cmsimde。</p>
<p style="padding-left: 30px;"><a href="http://229.cycu.org/cad_data.7z">cad_data.7z</a> (包括 NX2312、Blender4.2 與 Webots2023b，4.2GB)</p>
<p style="padding-left: 60px;">解開壓縮檔，將 nx、Webots_2023b 與 Blender 4.2 等目錄放入可攜系統的 data 目錄中。</p>
<p style="padding-left: 60px;">在命令列執行 webotsw 可啟動 Webots，設定 NX 使用授權後，執行 ugraf --nx 可啟動 NX2312。</p>
<p style="padding-left: 60px;">Webots2023b 啟動時需要 openssl_lh_set_thunks 函式，因為這是特別的 OpenSSL 介接，其目的可能是透過此函式與 OpenSSL 整合記憶體分配、除錯、或 OpenSSL 引擎擴充。</p>
<p style="padding-left: 60px;">目前已知 miniconda 中必須透過 conda install openssl=3.0.16 安裝舊版後的 openssl-3-x64.dll 中才會包含openssl_lh_set_thunks 函式。</p>
<p style="padding-left: 30px;"><a href="https://learn.microsoft.com/zh-tw/cpp/windows/latest-supported-vc-redist?view=msvc-170">Microsoft Visual C++ 可轉散發套件</a> (<a href="https://drive.google.com/file/d/10dzQbk_OT1Cm354rnk-2_sXwRRUmDrjK/view?usp=drive_link">VC_redist.x64.exe</a>)</p>
<p>由於 NX2312 中的 NXOpen Python 必須使用 Python 3.10 版的解譯器，才能與位於 y:\NX\NXBIN\python 目錄中的動態連結程式結合。</p>
<p>而 Webots_2023b 若要採 extern 外部控制器設定，則必須在切換 env 後，額外設定 PYTHONPATH 至 y:\Webots_2023b\msys64\mingw64\bin 以及 y:\Webots_2023b\lib\controller\python，才可連結其內建的 Python 控制器模組，只是 Webots 的控制器模組採 Python 程式碼編寫，因此可以在 Python 3.10 以上的版本中執行，因此只要 PYTHONPATH 納入 Webots 控制器模組後，可以選擇 base、cmsimde 或 nxopen 等 env 中的 Python 進行配置。</p>
<p>若 Webots Python 控制器需要額外安裝 numpy、scipy、opencv-python、matplotlib 或其他模組，也可以獨立配置一個 webots env 提供使用:</p>
<p style="padding-left: 30px;">conda create -p y:\envs\webots python=3.13</p>
<p style="padding-left: 30px;">conda activate y:\envs\webots</p>
<p style="padding-left: 30px;">where python</p>
<p style="padding-left: 30px;">conda clean --all</p>
<p style="padding-left: 30px;">並將 Webots 下拉式功能表中的 Tools - Preferences - Python command 欄位指向 webots env 所對應的 python，或者將控制器設為 extern，然後由 SciTE 選擇使用 Webots 合用的 Python 版本與模組套件。</p>
<p>Webots 啟動:</p>
<p style="padding-left: 30px;">webotsw --mode=pause (啟動時不會自動執行 controller)</p><h3>TimeStep</h3>
<p><span node="[object Object]">在 Webots 模擬器中，</span><strong><span node="[object Object]">模擬器的時間步長</span></strong><span node="[object Object]">與</span><strong><span node="[object Object]">世界的時間步長</span></strong><span node="[object Object]">是模擬運行的兩個重要概念，分別表示模擬器和模擬世界在離散物理計算中的時間間隔。以下是詳細說明：</span></p>
<div class="markdown-body MarkdownRenderer-module__container--wIGWk" data-copilot-markdown="true"><hr/><br/><span node="[object Object]">1. </span><strong><span node="[object Object]">模擬器的時間步長（Simulator </span><span node="[object Object]">Time </span><span node="[object Object]">Step）</span></strong>
<ul>
<li><strong><span node="[object Object]">定義</span></strong><span node="[object Object]">：模擬器內部用於計算物理模擬的時間間隔。它決定了模擬器每次更新物理場景時所模擬的時間量。</span></li>
<li><strong><span node="[object Object]">作用</span></strong><span node="[object Object]">：</span>
<ul>
<li><span node="[object Object]">控制系統的精度與性能。</span></li>
<li><span node="[object Object]">計算物理行為（如碰撞、運動等）的關鍵參數。</span></li>
</ul>
</li>
<li><strong><span node="[object Object]">設置方式</span></strong><span node="[object Object]">：模擬器的時間步長通常由模擬控制器中的代碼明確設置。例如，在 Python 控制器中，您可以使用</span><code node="[object Object]"><span node="[object Object]">robot.step(timestep)</span></code><span node="[object Object]">來進行控制。</span></li>
<li><strong><span node="[object Object]">特性</span></strong><span node="[object Object]">：</span>
<ul>
<li><strong><span node="[object Object]">越小</span></strong><span node="[object Object]">：模擬精度越高，但計算負擔增加，模擬速度可能變慢。</span></li>
<li><strong><span node="[object Object]">越大</span></strong><span node="[object Object]">：模擬速度提高，但精度降低，可能導致模擬不穩定。</span></li>
</ul>
</li>
</ul>
<hr/><br/><span node="[object Object]">2. </span><strong><span node="[object Object]">世界的時間步長（World </span><span node="[object Object]">Time </span><span node="[object Object]">Step）</span></strong>
<ul>
<li><strong><span node="[object Object]">定義</span></strong><span node="[object Object]">：模擬世界中用於更新場景的固定時間間隔，主要由 Webots 的場景樹（Scene </span><span node="[object Object]">Tree）中的 </span><code node="[object Object]"><span node="[object Object]">WorldInfo </span><span node="[object Object]">&gt; </span><span node="[object Object]">basicTimeStep</span></code> <span node="[object Object]">參數定義。</span></li>
<li><strong><span node="[object Object]">作用</span></strong><span node="[object Object]">：</span>
<ul>
<li><span node="[object Object]">控制整個模擬場景中物體更新的頻率。</span></li>
<li><span node="[object Object]">決定模擬器每次計算後，虛擬時間向前推進的時間量。</span></li>
</ul>
</li>
<li><strong><span node="[object Object]">設置方式</span></strong><span node="[object Object]">：可以在場景樹的 </span><code node="[object Object]"><span node="[object Object]">WorldInfo </span></code><span node="[object Object]">節點中修改 </span><code node="[object Object]"><span node="[object Object]">basicTimeStep </span></code><span node="[object Object]">參數值。</span></li>
<li><strong><span node="[object Object]">特性</span></strong><span node="[object Object]">：</span>
<ul>
<li><strong><span node="[object Object]">越小</span></strong><span node="[object Object]">：模擬的物理場景更新更加頻繁，但所需計算資源更多。</span></li>
<li><strong><span node="[object Object]">越大</span></strong><span node="[object Object]">：模擬場景更新較少，可能導致物理行為的細節丟失。</span></li>
</ul>
</li>
</ul>
<hr/><br/><span node="[object Object]">3. </span><strong><span node="[object Object]">兩者的關係</span></strong>
<ul>
<li><strong><span node="[object Object]">模擬器的時間步長</span></strong><span node="[object Object]">應該</span><strong><span node="[object Object]">小於或等於</span></strong><span node="[object Object]">世界的時間步長。</span>
<ul>
<li><span node="[object Object]">原因是：模擬器需要在每個世界時間步長內完成多次計算，以確保物理模擬的準確性。</span></li>
<li><span node="[object Object]">如果模擬器的時間步長大於世界的時間步長，可能導致模擬不穩定，甚至出現錯誤。</span></li>
</ul>
</li>
<li><strong><span node="[object Object]">設置建議</span></strong><span node="[object Object]">：</span>
<ul>
<li><span node="[object Object]">一般情況下，模擬器的時間步長可以設置為世界時間步長的一部分（如1/10）。</span></li>
<li><span node="[object Object]">測試不同的時間步長，根據模擬精度與性能需求進行調整。</span></li>
</ul>
</li>
</ul>
<hr/><br/><span node="[object Object]">4. </span><strong><span node="[object Object]">實際應用場景</span></strong>
<ul>
<li><strong><span node="[object Object]">模擬器的時間步長</span></strong><span node="[object Object]">：</span>
<ul>
<li><span node="[object Object]">用於控制機器人的控制器代碼，例如逐步執行機器人的操作或模擬傳感器的更新。</span></li>
</ul>
</li>
<li><strong><span node="[object Object]">世界的時間步長</span></strong><span node="[object Object]">：</span>
<ul>
<li><span node="[object Object]">用於控制整個模擬場景的更新頻率，例如物體的運動、碰撞檢測等。</span></li>
</ul>
</li>
</ul>
<hr/>
<h4>簡單對比</h4>
<table>
<thead>
<tr>
<th><strong><span node="[object Object]">項目</span></strong></th>
<th><strong><span node="[object Object]">模擬器的時間步長</span></strong></th>
<th><strong><span node="[object Object]">世界的時間步長</span></strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><span node="[object Object]">定義</span></strong></td>
<td><span node="[object Object]">模擬器內部計算的時間間隔</span></td>
<td><span node="[object Object]">模擬世界中場景更新的時間間隔</span></td>
</tr>
<tr>
<td><strong><span node="[object Object]">設置位置</span></strong></td>
<td><span node="[object Object]">控制器代碼中</span></td>
<td><span node="[object Object]">場景樹的</span><code node="[object Object]"><span node="[object Object]">WorldInfo</span></code><span node="[object Object]">節點</span></td>
</tr>
<tr>
<td><strong><span node="[object Object]">影響</span></strong></td>
<td><span node="[object Object]">控制模擬計算的精度與性能</span></td>
<td><span node="[object Object]">控制整個場景的更新頻率</span></td>
</tr>
<tr>
<td><strong><span node="[object Object]">大小關係</span></strong></td>
<td><span node="[object Object]">必須小於或等於世界時間步長</span></td>
<td><span node="[object Object]">可設置為模擬所需的任意值</span></td>
</tr>
</tbody>
</table>
<p><span node="[object Object]">透過合理設置這兩個參數，可以在模擬的精度與性能之間達到平衡。</span></p>
<h3>Clouds</h3>
<p><a href="https://cyberbotics.com/doc/guide/web-streaming">https://cyberbotics.com/doc/guide/web-streaming</a></p>
<p>Webots 透過 webotsw --stream 所啟動的串流伺服器, 可以將串流內容導向全球資訊網伺服器, 利用下列超文件透過 Websocket 檢視 Webots 串流場景.</p>
<p><a href="/downloads/index4.html.txt">index4.html</a></p>
<pre class="brush:html;auto-links:false;toolbar:false" contenteditable="false">&lt;!DOCTYPE html&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;

  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge" /&gt;
    &lt;title&gt;Streaming viewer&lt;/title&gt;
    &lt;link rel="icon" type="image/png" href="webots_icon.png"&gt;
    &lt;link type="text/css" rel="stylesheet" href='style.css' /&gt;
    &lt;style&gt;
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        width: 100vw;
        height: 100vh;
        min-height: 100vh;
        min-width: 100vw;
        display: flex;
        flex-direction: column;
        background: #222;
      }
      header {
        flex: 0 0 auto;
        padding: 0;
        margin: 0;
        background: #181818;
        color: #fff;
        text-align: center;
      }
      .title-container {
        margin: 0;
        padding: 0.5em 0;
      }
      .webots-view-container {
        flex: 1 1 0;
        display: flex;
        align-items: stretch;
        justify-content: stretch;
        min-height: 0;
        min-width: 0;
      }
      webots-view {
        width: 100vw;
        height: 100vh;
        flex: 1 1 0;
        display: block;
        min-width: 0;
        min-height: 0;
      }
    &lt;/style&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;div class="webots-view-container"&gt;
      &lt;webots-view&gt;&lt;/webots-view&gt;
    &lt;/div&gt;
    &lt;script type="module" src="http://localhost:8000/wwi/WebotsView.js"&gt;&lt;/script&gt;
    &lt;script&gt;
      // Default WebSocket parameters
      const defaultIp = "ws://localhost:1234";
      const defaultStreamingMode = "x3d";
      const defaultBroadcast = false;
      const mobileDevice = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      const defaultThumbnail = './../wwi/images/loading/default_thumbnail.png';

      // Optional: load mobile CSS if on mobile device
      if (mobileDevice) {
        let head = document.getElementsByTagName('head')[0];
        let mobileCss = document.createElement('link');
        mobileCss.setAttribute('rel', 'stylesheet');
        mobileCss.setAttribute('type', 'text/css');
        mobileCss.setAttribute('href', './../wwi/css/wwi_mobile.css');
        head.appendChild(mobileCss);
      }

      // Wait for WebotsView.js to load and custom element to be defined
      window.addEventListener('DOMContentLoaded', () =&gt; {
        customElements.whenDefined('webots-view').then(() =&gt; {
          const webotsView = document.querySelector('webots-view');
          webotsView.onready = () =&gt; {
            console.log("Connected to Webots streaming server!");
          };
          webotsView.ondisconnect = () =&gt; {
            console.log("Disconnected from Webots streaming server!");
          };
          webotsView.connect(defaultIp, defaultStreamingMode, defaultBroadcast, mobileDevice, -1, defaultThumbnail);
        });
      });
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
<p>下列 Python 程式執行時則可動態建立近端伺服器, 並直接利用 Edge 開啟 index4.html 中的 Webots 場景.</p>
<p>python_www_server.py</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">import http.server
import socketserver
import threading
import webbrowser
import time
import os
import sys
import subprocess

PORT = 8000
DIRECTORY = os.path.dirname(os.path.abspath(__file__))

class Handler(http.server.SimpleHTTPRequestHandler):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, directory=DIRECTORY, **kwargs)

def open_edge(url):
    # Try common Edge paths on Windows
    edge_paths = [
        r"C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe",
        r"C:\Program Files\Microsoft\Edge\Application\msedge.exe"
    ]
    for path in edge_paths:
        if os.path.exists(path):
            subprocess.Popen([path, url])
            return True
    # Fallback: try using webbrowser module (may open in default browser)
    try:
        webbrowser.get('windows-default').open(url)
    except:
        webbrowser.open(url)
    return False

def run_server():
    with socketserver.TCPServer(("", PORT), Handler) as httpd:
        print(f"Serving at http://localhost:{PORT}")
        httpd.serve_forever()

if __name__ == "__main__":
    # Start server in a thread
    server_thread = threading.Thread(target=run_server, daemon=True)
    server_thread.start()

    # Wait a moment for the server to start
    time.sleep(1)

    # Open Edge to the local index.html
    url = f"http://localhost:{PORT}/streaming_viewer/index4.html"
    print(f"Opening {url} in Edge...")
    open_edge(url)

    # Keep main thread alive to keep server running
    try:
        while True:
            time.sleep(10)
    except KeyboardInterrupt:
        print("Shutting down.")
        sys.exit(0)</pre>
<p><a href="/downloads/webots_stream.7z">webots_stream.7z</a></p>
<p>在雲端提供多 Webots 場景串流的方法是, 每一個場景採</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">webotsw my_world.wbt --stream --port 8888</pre>
<p>在 8888 埠號串流 my_world.wbt 場景, 並在 WWW 伺服器中指定要開啟的 port 就能利用一台雲端主機檢視多個由使用者上傳的場景. 再加上 https 設定, 建立類似 <a href="https://webots.cloud/">https://webots.cloud/</a> 的服務.</p>
<p>cloud (<a href="https://github.com/cyberbotics/webots-cloud">https://github.com/cyberbotics/webots-cloud</a>) 中的 html 如下:</p>
<pre class="brush:html;auto-links:false;toolbar:false" contenteditable="false">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta charset="utf-8"&gt;
  &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"&gt;
  &lt;title id="title"&gt;webots.cloud&lt;/title&gt;
  &lt;meta name="description" content="Run Webots simulations in the cloud"&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
  &lt;meta name="og:locale" content="en"&gt;
  &lt;meta name="og:type" content="website"&gt;
  &lt;meta name="og:title" content="webots.cloud"&gt;
  &lt;meta name="og:description" content="The place to share Webots simulations."&gt;
  &lt;meta name="og:updated_time" content="1587637793"&gt;
  &lt;link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /&gt;
  &lt;link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css"&gt;
  &lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.css"&gt;
  &lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css"/&gt;
  &lt;link rel="stylesheet" href="/css/webots-cloud.css"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div class="scrollable-body" id="scrollable-body"&gt;&lt;/div&gt;
  &lt;script src="/js/webots-cloud.js" type="module"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.3.0/showdown.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cyberbotics.com/showdown/1.3.0/showdown-youtube.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/7.0.0/mermaidAPI.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdn.jsdelivr.net/gh/cyberbotics/webots@released/docs/js/showdown-extensions.js"&gt;&lt;/script&gt;
&lt;/html&gt;
</pre>
<p>在 w_dot_mde 設定:</p>
<p>nginx.conf (主要讓 wss:// 透過 https 反向代理.</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">#user  nobody;
worker_processes  1;
 
#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;
 
#pid        logs/nginx.pid;
 
events {
    worker_connections  1024;
}
 
http {
    include       mime.types;
    default_type  application/octet-stream;
 
    sendfile        on;
    keepalive_timeout  65;
 
    # Redirect HTTP to HTTPS
    server {
        listen [2001:288:6004:17::XX]:80;
        server_name  XX.nfu.edu.tw;
 
        return 301 https://$host$request_uri;
    }
 
    # HTTPS server
    server {
        listen [2001:288:6004:17::XX]:443 ssl;
        server_name XX..nfu.edu.tw;
 
        ssl_certificate      C:/Certbot/live/w.mde.nfu.edu.tw/fullchain.pem;
        ssl_certificate_key  C:/Certbot/live/w.mde.nfu.edu.tw/privkey.pem;
 
        ssl_protocols        TLSv1.2 TLSv1.3;
        ssl_ciphers          HIGH:!aNULL:!MD5;
 
        location / {
            #root   html;
            root html/webots_resources_web/;
            index  index.html index.htm;
        }
        
        # Webots streaming server 的 WebSocket 反向代理
        location /webots_ws/ {
            proxy_pass http://localhost:1234/;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }

        location /auto_shoot/ {
            proxy_pass http://localhost:1235/;
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }
 
        error_page 404 /404.html;
        location = /40x.html {
        }
 
        error_page 500 502 503 504 /50x.html;
        location = /50x.html {
        }
    }
}</pre>
<p>此時的 index.html 設為:</p>
<pre class="brush:html;auto-links:false;toolbar:false" contenteditable="false">&lt;!DOCTYPE html&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
  &lt;head&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge" /&gt;
    &lt;title&gt;Streaming viewer&lt;/title&gt;
    &lt;link rel="icon" type="image/png" href="webots_icon.png"&gt;
    &lt;link type="text/css" rel="stylesheet" href='style.css' /&gt;
    &lt;style&gt;
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        width: 100vw;
        height: 100vh;
        min-height: 100vh;
        min-width: 100vw;
        display: flex;
        flex-direction: column;
        background: #222;
      }
      header {
        flex: 0 0 auto;
        padding: 0;
        margin: 0;
        background: #181818;
        color: #fff;
        text-align: center;
      }
      .title-container {
        margin: 0;
        padding: 0.5em 0;
      }
      .webots-view-container {
        flex: 1 1 0;
        display: flex;
        align-items: stretch;
        justify-content: stretch;
        min-height: 0;
        min-width: 0;
      }
      webots-view {
        width: 100vw;
        height: 100vh;
        flex: 1 1 0;
        display: block;
        min-width: 0;
        min-height: 0;
      }
    &lt;/style&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class="webots-view-container"&gt;
      &lt;webots-view&gt;&lt;/webots-view&gt;
    &lt;/div&gt;
    &lt;script type="module" src="./../wwi/WebotsView.js"&gt;&lt;/script&gt;
    &lt;script&gt;
      // 根據當前協定與主機自動組成 wss/ws 路徑
      const wsProtocol = (window.location.protocol === "https:") ? "wss:" : "ws:";
      const wsHost = window.location.host;
      // 注意：此處路徑要跟 nginx location /webots_ws/ 一致
      const defaultIp = wsProtocol + "//" + wsHost + "/webots_ws/";
      const defaultStreamingMode = "x3d";
      const defaultBroadcast = false;
      const mobileDevice = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      const defaultThumbnail = './../wwi/images/loading/default_thumbnail.png';

      // Optional: load mobile CSS if on mobile device
      if (mobileDevice) {
        let head = document.getElementsByTagName('head')[0];
        let mobileCss = document.createElement('link');
        mobileCss.setAttribute('rel', 'stylesheet');
        mobileCss.setAttribute('type', 'text/css');
        mobileCss.setAttribute('href', './../wwi/css/wwi_mobile.css');
        head.appendChild(mobileCss);
      }

      // Wait for WebotsView.js to load and custom element to be defined
      window.addEventListener('DOMContentLoaded', () =&gt; {
        customElements.whenDefined('webots-view').then(() =&gt; {
          const webotsView = document.querySelector('webots-view');
          webotsView.onready = () =&gt; {
            console.log("Connected to Webots streaming server!");
          };
          webotsView.ondisconnect = () =&gt; {
            console.log("Disconnected from Webots streaming server!");
          };
          webotsView.connect(defaultIp, defaultStreamingMode, defaultBroadcast, mobileDevice, -1, defaultThumbnail);
        });
      });
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>
<p><a href="/downloads/auto_shoot.html.txt">auto_shoot.html</a></p>
<p>Webots headless command:</p>
<p>webots --no-rendering --stream --batch --port=1234  C:\portable_wcm2025_big\data\Webots_2023b\projects\vehicles\worlds\city.wbt</p>
<p><span>Since Webots runs in headless mode, the </span><code>--stdout</code><span><span> </span>and<span> </span></span><code>--stderr</code><span><span> </span>arguments are used to redirect these streams from the Webots console to the console in which Webots was started, the<span> </span></span><code>--batch</code><span><span> </span>argument disables any blocking pop-up window and the<span> </span></span><code>--mode=realtime</code><span><span> </span>makes sure that the simulation is not started in pause mode (you may replace<span> </span></span><code>realtime</code><span><span> </span>by<span> </span></span><code>fast</code><span>), finally don't forget to specify which simulation you want to run.</span></p>
<p><span><a href="https://www.cyberbotics.com/doc/guide/installation-procedure?version=develop#installing-the-docker-image">https://www.cyberbotics.com/doc/guide/installation-procedure?version=develop#installing-the-docker-image</a> </span></p>
<p><span><a href="https://gist.github.com/cyberang3l/422a77a47bdc15a0824d5cca47e64ba2">https://gist.github.com/cyberang3l/422a77a47bdc15a0824d5cca47e64ba2</a> </span></p>
<p>與可攜系統同時啟動:</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">@echo off
set Disk=y
subst %Disk%: "data"

%Disk%:

set HomePath=%Disk%:\home_ipv6
set HomeDrive=%Disk%:\home_ipv6
set Home=%Disk%:\home_ipv6
set USERPROFILE=%Disk%:\home_ipv6

REM 將系統 Python 程式的 io 設為 utf-8
set PYTHONIOENCODING="utf-8"

set PYTHONPATH=%Disk%:\Python313\DLLs;%Disk%:\Python313\Lib;%Disk%:\Python313\Lib\site-packages;%Disk%:\NX\NXBIN\python;%Disk%:\Webots_2023b\msys64\mingw64\bin;%Disk%:\Webots_2023b\lib\controller\python;
set PYTHONHOME=%Disk%:\Python313
REM for Webots
set PYTHON_PATH=%Disk%:\Python313
set WEBOTS_HOME=%Disk%:\Webots_2023b

REM for putty
set GIT_SSH=%Disk%:\PuTTY\plink.exe

REM for Java and Android SDK
set java_home=%Disk%:\java\jdk8u222-b10
set ANDROID_SDK_home=%Disk%:\home_ipv6
set GRADLE_USER_home=%Disk%:\home_ipv6
set ANDROID_SDK_ROOT=%Disk%:\android\sdk
set ANDROID_Home=%Disk%:\android\sdk
set REPO_OS_OVERRIDE=windows

REM 設定跟 Python 有關的命令搜尋路徑
set path_python=%Disk%:\Python313;%Disk%:\Python313\Scripts;
REM 設定跟Git 有關的命令搜尋路徑
set path_git=%Disk%:\portablegit\bin;
REM 設定 msys2 64 位元的執行路徑
REM %Disk%:\msys64\mingw64\bin is for GD library
set path_msys2=%Disk%:\msys64\ucrt64\bin;%Disk%:\msys64\mingw64\bin;
REM set for LaTeX
set path_miketex=%Disk%:\miktex-portable\texmfs\install\miktex\bin\x64;
REM Flutter path
set path_flutter=%Disk%:\flutter\bin;%java_home%\bin;%Disk%:\Android\sdk;%Disk%:\Android\sdk\tools;%Disk%:\Android\sdk\tools\bin;%Disk%:\Android\sdk\emulator;%Disk%:\Android\sdk\platform-tools;%Disk%:\flutter\bin\cache\dart-sdk\bin;%Disk%:\vscode;
set path_node=%Disk%:\node-v14.15.4-win-x64;

set path_postgresql=%Disk%:\postgresql13\bin;
set path_range=%Disk%:\Range3_official\bin;
rem set path_range=%Disk%:\range-3.2.5_kmol\bin;
set path_lua=%Disk%:\lua-5.3.5\;
set path_core=%Disk%:\coreutils-5.3.0\bin;
REM for gogs
set path_putty=%Disk%:\PuTTY;
set path_vscode=%Disk%:\vscode;

REM for Rust
set MINGW_PATH=%path_msys2%;
set GIT_PATH=%path_git%;
set VSCODE_PATH=%path_vscode%
set RUSTUP_HOME=%Disk%:\Rust\rust
set CARGO_HOME=%Disk%:\Rust\cargo
set RUST_PATH=%CARGO_HOME%\bin

REM for Erlang and Elixir
set path_erlang=%Disk%:\elixir\erl10.7\bin\;%Disk%:\elixir\erl10.7\erts-10.7\bin;%Disk%:\elixir\elixir\bin;
set ERTSPATH=%Disk%:\elixir\erl10.7\erts-10.7\bin
set ERLINI=%Disk%:\elixir\erl10.7\erts-10.7\bin\erl.ini

REM for Haskell
set path_haskell=%Disk%:\ghc-9.0.1-x86_64-unknown-mingw32\bin;
REM for node.js
set path_nodejs=%Disk%:\node-v14.17.2-x64\nodejs;%Disk%:\node-v14.17.2-x64\nodejs\node_modules\npm;

REM 加入 PostgreSQL 所需的環境變數設定

@SET PGDATA=%Disk%:\postgresql13\data
@SET PGDATABASE=postgres
@SET PGUSER=postgres
@SET PGPORT=5432
@SET PGLOCALEDIR=%Disk%:\postgresql13\share\locale

REM for Range3
REM REG IMPORT %Disk%:\range3.reg

REM proxy needed for heroku login
REM proxy can not use with fossil scm
REM proxy can not use with Rust installation
REM needed for node.js
REM set HTTP_PROXY=http://[2001:288:6004:xx::42]:3128
REM set HTTPS_PROXY=http://[2001:288:6004:xx::42]:3128

REM for PyRep
set VREP_PATH=%Disk%:\CoppeliaSim

REM BOOST_ROOT for compiling coppeliasim but maybe not for linking
REM set BOOST_ROOT=%Disk%:\boost_1_76_0\;
set path_copsim=%Disk%:\boost_1_76_0\;%Disk%:\Strawberry\perl\bin;%Disk%:\cmake-3.21.0-windows-x86_64\bin;%Disk%:\diffutils-2.8.7-1\bin;%Disk%:\patch-2.5.9-7\bin;%D%:\jom_1_1_2;%Disk%:\LLVM\bin;%Disk%:\QtCreator\bin;%Disk%:\CoppeliaSimEdu;%Disk%:\Python313\tcl\tcl8.6;

REM for CMake
set CMAKE_C_COMPILER=%Disk%:\msys64\ucrt64\bin\gcc;
set CMAKE_CXX_COMPILER=%Disk%:\msys64\ucrt64\bin\g++;

REM set QT_QPA_PLATFORM_PLUGIN_PATH=Y:\msys64_20240507\mingw64\share\qt5\plugins\platforms
REM set QT_PLUGIN_PATH=Y:\msys64_20240507\mingw64\share\qt5\plugins

REM for execute scite directly
set path_scite=%Disk%:\wscite\;

REM for simExtZMQ
set path_xsltproc=%Disk%:\xsltproc;

REM for OpenSSL
Set OPENSSL_CONF=%Disk%:\OpenSSL-Win64\SSL\openssl.cnf
set path_openssl=%Disk%:\OpenSSL-Win64\bin;

REM for textract
set path_poppler=%Disk%:\poppler-24.07.0\Library\bin;

REM for tiny C compiler
set path_tcc=%Disk%:\tcc;

REM for webots
set  path_webots=%Disk%:\Webots_2023b\msys64\mingw64\bin;%Disk%:\Webots_2023b\msys64\usr\bin

REM for blender
set path_blender=%Disk%:\Blender 4.2;

path=%Disk%:;%path_python%;%path_git%;%path_copsim%;%path_msys2%;%path_miketex%;%path_flutter%;%path_node%;%path_tcc%;%path_postgresql%;%path_range%;%path_lua%;%path_core%;%path_putty%;%path_vscode%;%RUST_PATH%;%path_erlang%;%path_nodejs%;%path_haskell%;%path_scite%;%path_xsltproc%;%path_gnuplot%;%path_openssl%;%path_poppler%;%path_webots%;%path_blender%;%path%;

REM for NX2312, must after path setup 
set SPLM_LICENSE_SERVER=29000@your_server
set UGII_LANG=english
set UGS_LICENSE_BUNDLE=ACD11,ACD10
set UGII_BASE_DIR=%Disk%:\NX\
set UGII_TMP_DIR=%Disk%:\NX\temp
set UGII_LIB_PATH=%Disk%:\NX\NXBIN\python
set ugii=%Disk%:\NX\ugii;%Disk%:\NX\nxbin;
path = %ugii%;%path%
REM Xcopy %Disk%:\home_ipv6\AppData\Local\Siemens\NX2312 C:\users\%USERNAME%\AppData\Local\Siemens\NX2312 /E /H /C /I /Y

REM start ugraf -nx

REM python %Disk%:\tmp\nx_ex\new_part.py

start /MIN cmd.exe
start /MIN cmd.exe
start /MIN cmd.exe
start /MIN cmd.exe

start /MIN %Disk%:\wscite\SciTE.exe
start /MIN %Disk%:\wscite\SciTE.exe

REM start webotsw.exe

start webots.exe --no-rendering --minimize --stream --stdout --stderr --batch --mode=realtime --port=1234  C:\portable_wcm2025_big\data\Webots_2023b\projects\vehicles\worlds\city.wbt
start webots.exe --no-rendering --minimize --stream --stdout --stderr --batch --mode=realtime --port=1235  C:\Webots_server\webots_projects\cd2025_final_project_w17\worlds\w17_auto_loop.wbt


Exit
</pre>
<h3>Talks</h3>
<p><a href="https://www.theconstruct.ai/webots-robot-simulator-ros-olivier-michel/">https://www.theconstruct.ai/webots-robot-simulator-ros-olivier-michel/</a> </p>
<h3>Blender</h3>
<p>Blender: <a href="https://www.blender.org/">https://www.blender.org/</a></p>
<p><a href="https://github.com/cyberbotics/blender-webots-exporter">https://github.com/cyberbotics/blender-webots-exporter</a> </p>
<h3>Ardupilot</h3>
<p><a href="https://ardupilot.org/dev/docs/sitl-with-webots-cpp.html">https://ardupilot.org/dev/docs/sitl-with-webots-cpp.html</a> </p>
<p><a href="https://ardupilot.org/rover/index.html">https://ardupilot.org/rover/index.html</a> </p>
<h1>Projects</h1>
<p>利用 Solvespae、NX 與 Onshape 建立下列的五軸機械臂零組件</p>
<h4>Linkages</h4>
<p style="padding-left: 30px;"><a href="https://blog.rectorsquid.com/linkage-mechanism-designer-and-simulator/">https://blog.rectorsquid.com/linkage-mechanism-designer-and-simulator/</a> </p>
<p style="padding-left: 30px;">5-bar</p>
<p style="padding-left: 30px;"><a href="/downloads/plotter.7z">plotter.7z</a> (in Solvespace)</p>
<p style="padding-left: 30px;"><img alt="" height="300" src="/images/5bar_simulation.gif" width="300"/></p>
<p style="padding-left: 30px;"><img alt="" height="300" src="/images/mickey_mouse_plot.gif" width="300"/></p>
<p style="padding-left: 30px;"><img caption="false" height="348" src="/images/fivebar_plotter.gif" width="500"/></p>
<p style="padding-left: 30px;"><a href="/downloads/fivebar_parallel_linkage.7z">fivebar_parallel_linkage.7z</a> (in Solidworks and NX2312)</p>
<p style="padding-left: 30px;"><a href="https://github.com/mdecycu/5-Bar-Parallel-Robot-Kinematics-Simulation">https://github.com/mdecycu/5-Bar-Parallel-Robot-Kinematics-Simulation</a> </p>
<p style="padding-left: 30px;"><a href="https://github.com/mdecycu/parallel-five-bar-robot">https://github.com/mdecycu/parallel-five-bar-robot</a> </p>
<p style="padding-left: 30px;"><a href="https://github.com/mdecycu/five_bar_linkage">https://github.com/mdecycu/five_bar_linkage</a> </p>
<p style="padding-left: 30px;"><a href="https://github.com/mdecycu/FrostBot">https://github.com/mdecycu/FrostBot</a></p>
<p style="padding-left: 30px;"><a href="https://github.com/mdecycu/Robot-Sketcher-5-bar-parallel-manipulator-">https://github.com/mdecycu/Robot-Sketcher-5-bar-parallel-manipulator-</a> </p>
<p style="padding-left: 30px;"><a href="https://www.researchgate.net/publication/277299749_User's_manual_for_the_DexTAR_five-bar_parallel_robot">https://www.researchgate.net/publication/277299749_User's_manual_for_the_DexTAR_five-bar_parallel_robot</a></p>
<p style="padding-left: 30px;"><a href="https://www.mathworks.com/help/sm/ug/five-bar-robot.html">https://www.mathworks.com/help/sm/ug/five-bar-robot.html</a></p>
<p style="padding-left: 30px;"><a href="https://www.mdpi.com/2075-1702/10/11/971">Optimal Design of a Five-Bar Planar Manipulator and Its Controller by Using Different Algorithms for Minimum Shaking Forces and Moments for the Largest Trajectory in a Usable Workspace </a></p>
<p style="padding-left: 30px;"><a href="https://www.sciencedirect.com/science/article/pii/S0736584512001214">Kinematic calibration of a five-bar planar parallel robot using all working modes</a></p>
<p style="padding-left: 30px;"><a href="https://ieeexplore.ieee.org/document/9330526">Concurrent Design of a 2 Dof Five-Bar Parallel Robot a Hybrid Design of Rigid and Flexible Links</a></p>
<p style="padding-left: 30px;"><a href="/downloads/Kinematic Analysis of Five-Bar Mechanism.pdf">Kinematic Analysis of Five-Bar Mechanism.pdf</a></p>
<p><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" frameborder="0" height="315" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/dvi_3OcbsCI?si=uViJq3nPdyN4Jkda" title="YouTube video player" width="560"></iframe></p>
<p><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" frameborder="0" height="315" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/cPmnAHVEEYM?si=1qf8mlXzjz7RzdqQ" title="YouTube video player" width="560"></iframe></p>
<p><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" frameborder="0" height="315" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/yubS3_OUhQs?si=QGv55rstovztoQm2" title="YouTube video player" width="560"></iframe></p>
<p><a href="https://link.springer.com/chapter/10.1007/978-3-319-98020-1_28">Kinematic Design of Five-Bar Parallel Robot by Kinematically Defined Performance Index for Energy Consumption</a></p>
<p><a href="https://github.com/Phylliade/ikpy">https://github.com/Phylliade/ikpy</a> </p>
<p><a href="https://hackaday.io/project/173325-educational-five-bar-parallel-robot">https://hackaday.io/project/173325-educational-five-bar-parallel-robot</a></p>
<div class="markdown-body MarkdownRenderer-module__container--wIGWk" data-copilot-markdown="true" style="--markdownrenderer_streaming-fade-duration: 750ms;"></div>
<h2>Control</h2>
<p><a href="https://link.springer.com/book/10.1007/978-1-4842-9600-4">Essentials of Arduino Boards Programming</a> (電子書)  </p>
<p><a href="/downloads/PythonForControl.pdf">PythonForControl.pdf</a></p>
<p><a href="https://openmodelica.org/">OpenModelica</a> + <a href="https://github.com/modelon-community/PyFMI">Pyfmi</a> + Webots</p>
<p>1. 在 Modelica 建立控制器:</p>
<pre class="brush:js;auto-links:false;toolbar:false" contenteditable="false">model SimplePIDController
  input Real position;
  output Real torque;

  parameter Real Kp = 2.0;
  parameter Real Kd = 0.5;

  Real error;
  Real derror;
initial equation
  error = 0;
  derror = 0;
equation
  error = 0 - position;
  derror = der(error);
  torque = Kp * error + Kd * derror;
end SimplePIDController;
</pre>
<p>2. 匯出為 FMU</p>
<p>用 OpenModelica，匯出此模型為 FMU：<br/><br/>    使用 OMEdit ➜ 選擇 Export ➜ FMI<br/><br/>    勾選：<br/><br/>        ✔ FMU for Co-Simulation<br/><br/>        或 ✔ FMU for Model Exchange（自行利用 PyFMI 提供 solver）</p>
<p>會產生一個 .fmu 檔（zip 檔格式）。</p>
<p>3. Webots 中撰寫 Python 控制器:</p>
<p>以便讓 Webots 的機器人由 FMU 控制。</p>
<pre class="brush:py;auto-links:false;toolbar:false" contenteditable="false">from controller import Robot
from pyfmi import load_fmu

# Webots 設定
robot = Robot()
timestep = int(robot.getBasicTimeStep())

# 載入 FMU 控制器
controller = load_fmu("SimplePIDController.fmu")
controller.initialize()

# 獲取感測器與馬達
joint_sensor = robot.getPositionSensor("my_joint_sensor")
joint_sensor.enable(timestep)

motor = robot.getMotor("my_joint_motor")

while robot.step(timestep) != -1:
    position = joint_sensor.getValue()
    
    # 設定 FMU 輸入
    controller.set("position", position)
    
    # 執行一步 FMU 模型
    controller.do_step(current_t=robot.getTime(), step_size=timestep / 1000.0)
    
    # 取得輸出
    torque = controller.get("torque")
    
    # 輸出至 Webots 馬達
    motor.setTorque(torque)
</pre>
<p></p>
<h2>Printer</h2>
<p>這裡所指的 Printer 是 3D 列印機。</p>
<p><a href="https://en.wikipedia.org/wiki/3D_printing">3D Printing</a>:</p>
<p><b>3D printing</b>, or<span> </span><b>additive manufacturing</b>, is the<span> </span><a href="https://en.wikipedia.org/wiki/Manufacturing" title="Manufacturing">construction</a><span> </span>of a<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Three-dimensional_object" title="Three-dimensional object">three-dimensional object</a><span> </span>from a<span> </span><a href="https://en.wikipedia.org/wiki/Computer-aided_design" title="Computer-aided design">CAD</a><span> </span>model or a digital<span> </span><a href="https://en.wikipedia.org/wiki/3D_modeling" title="3D modeling">3D model</a>.<span> </span>It can be done in a variety of processes in which material is deposited, joined or solidified under<span> </span><a class="mw-redirect" href="https://en.wikipedia.org/wiki/Computer_Numerical_Control" title="Computer Numerical Control">computer control</a>,<span> </span>with the material being added together (such as plastics, liquids or powder grains being fused), typically layer by layer.</p>
<p>In the 1980s, 3D printing techniques were considered suitable only for the production of functional or aesthetic prototypes, and a more appropriate term for it at the time was<span> </span><a href="https://en.wikipedia.org/wiki/Rapid_prototyping" title="Rapid prototyping">rapid prototyping</a>.<span> </span>As of 2019, the precision, repeatability, and material range of 3D printing have increased to the point that some 3D printing processes are considered viable as an industrial-production technology; in this context, the term<span> </span><i>additive manufacturing</i><span> </span>can be used synonymously with<span> </span><i>3D printing</i>.One of the key advantages of 3D printing<span> </span>is the ability to produce very complex shapes or geometries that would be otherwise infeasible to construct by hand, including hollow parts or parts with internal<span> </span><a href="https://en.wikipedia.org/wiki/Truss" title="Truss">truss</a><span> </span>structures to reduce weight while creating less material waste.<span> </span><a href="https://en.wikipedia.org/wiki/Fused_filament_fabrication#Fused_deposition_modeling" title="Fused filament fabrication">Fused deposition modeling</a><span> </span>(FDM), which uses a continuous filament of a<span> </span><a href="https://en.wikipedia.org/wiki/Thermoplastic" title="Thermoplastic">thermoplastic</a><span> </span>material, is the most common 3D printing process in use as of 2020.</p>
<h2>Otto_ninja</h2>
<p><a href="https://www.printables.com/model/231580-otto-ninja-starter-robot/files">https://www.printables.com/model/231580-otto-ninja-starter-robot/files</a> </p>
<p><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" frameborder="0" height="315" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/NDIwhuxQPN8?si=ED_FAObUkAVFT5L-" title="YouTube video player" width="560"></iframe></p>
<h3>Simplify</h3>
<p>以下程式碼是一個專為 Blender 設計的 Python 程式，其目的是將複雜的 3D 模型零件簡化為凸包（Convex Hull），並在簡化後保留原始物件的物理屬性，最後將簡化後的模型匯出。<br/><br/>由於利用 CAD 繪出的零件，轉入 Webots 進行剛體動力學模擬運算時，若能將幾何外形轉換為網格資料較為簡單的凸包，可大幅減少物理引擎的運算負擔，進而提升模擬的流暢度和穩定性。<br/><br/>以下是程式碼的設計原理與主要流程：<br/><br/>設計原理:</p>
<p>分離設定與核心邏輯：程式碼將使用者可修改的參數（如檔案路徑、格式、簡化比率）放在程式開頭的「使用者設定」區塊，而將實際執行的功能封裝在獨立的函式中。這種設計使程式易於修改和維護，使用者不需要理解複雜的內部邏輯就能快速調整參數。<br/><br/>模組化函式：每個函式負責一個單一且明確的任務，例如 clear_scene() 清空場景、import_all_parts() 匯入模型、get_physics_properties() 獲取物理屬性等等。這種模組化設計使程式碼結構清晰，易於除錯和理解。<br/><br/>穩健的錯誤處理：在 import_all_parts()、get_physics_properties() 等函式中，程式碼都包含了對異常情況（如檔案夾不存在、物件無效）的檢查和錯誤訊息輸出。這確保了腳本在遇到問題時不會無故崩潰，而是能給出有用的提示。</p>
<p>複製-簡化-匹配三階段工作流程：</p>
<p style="padding-left: 30px;">複製：為每個原始零件建立一個副本。這樣可以避免直接修改原始物件。</p>
<p style="padding-left: 30px;">簡化：對這個副本執行凸包（Convex Hull）運算。凸包是一個包含原始物體所有頂點的最小凸多面體，可以將複雜的幾何體轉化為簡單的凸體。</p>
<p style="padding-left: 30px;">匹配：將簡化後的凸包賦予原始物件的物理屬性，包括位置、旋轉和質量。</p>
<p style="padding-left: 30px;">匯出：最後，刪除原始物件，只匯出簡化後的凸包。</p>
<p>利用 Blender scripting 簡化 OBJ 組立檔中的個別零件: <a href="/downloads/blender_simplify_obj_parts.7z">blender_simplify_obj_parts.7z</a></p>
<p><a href="/downloads/simplify_parts_v2.py">simplify_parts_v2.py</a></p><h1>Brython</h1>
<p><button id="add1to100">1 add to 100</button></p>
<p><span node="[object Object]"><!-- 導入 brython 程式庫 --></span></p>
<p>
<script src="/static/brython.js"></script>
<script src="/static/brython_stdlib.js"></script>
</p>
<p><span node="[object Object]"><!-- 啟動 Brython --></span></p>
<p>
<script>
window.onload=function(){
brython({debug:1, pythonpath:['/static/','./../downloads/py/']});
}
</script>
</p>
<p><!-- 導入 FileSaver 與 filereader --></p>
<p>
<script src="/static/ace/FileSaver.min.js" type="text/javascript"></script>
<script src="/static/ace/filereader.js" type="text/javascript"></script>
</p>
<p><!-- 導入 ace --></p>
<p>
<script src="/static/ace/ace.js" type="text/javascript"></script>
<script src="/static/ace/ext-language_tools.js" type="text/javascript"></script>
<script src="/static/ace/mode-python3.js" type="text/javascript"></script>
<script src="/static/ace/snippets/python.js" type="text/javascript"></script>
</p>
<p><!-- 導入 gearUtils-0.9.js Cango 齒輪繪圖程式庫 -->
<script src="/static/Cango-24v03-min.js"></script>
<script src="/static/gearUtils-09.js"></script>
<script src="/static/SVGpathUtils-6v03-min.js"></script>
<script src="/static/sylvester.js"></script>
<script src="/static/PrairieDraw.js"></script>
</p>
<p><!-- 請注意, 這裡使用 Javascript 將 localStorage["kw_py_src1"] 中存在近端瀏覽器的程式碼, 由使用者決定存檔名稱--></p>
<p>
<script type="text/javascript">
function doSave(storage_id, filename){
    var blob = new Blob([localStorage[storage_id]], {type: "text/plain;charset=utf-8"});
    filename = document.getElementById(filename).value
    saveAs(blob, filename+".py");
}
</script>
</p>
<p>
<script type="text/python3">
from browser import document as doc
import ace
# 清除畫布
def clear_bd1(ev):
    bd = doc["brython_div1"]
    bd.clear()
Ace1 = ace.Editor(editor_id="kw_editor1", console_id="kw_console1", container_id="kw__container1", storage_id="kw_py_src1" )
# 從 gist 取出程式碼後, 放入 editor 作為 default 程式
def run1():
    # 利用 get 取下 src 變數值
    try:
        url = doc.query["src"]
    except:
        url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c3a6deaf717f8f2739a4b1392a5ab10936e9693a/from_1_add_to_10_1.py"
    prog = open(url).read()

    # 將程式載入編輯區
    Ace1.editor.setValue(prog)
    Ace1.editor.scrollToRow(0)
    Ace1.editor.gotoLine(0)
    # 直接執行程式
    #ns = {'__name__':'__main__'}
    #exec(prog, ns)
    # 按下 run 按鈕
    Ace1.run()

# 執行程式, 顯示輸出結果與清除輸出結果及對應按鈕綁定
doc['kw_run1'].bind('click', Ace1.run)
doc['kw_show_console1'].bind('click', Ace1.show_console)
doc['kw_clear_console1'].bind('click', Ace1.clear_console)
doc['clear_bd1'].bind('click', clear_bd1)
# 呼叫函式執行
run1()
</script>
</p>
<p><!-- add 1 to 100 開始 -->
<script type="text/python3">
from browser import document as doc
import ace

# 清除畫布
def clear_bd1(ev):
    bd = doc["brython_div1"]
    bd.clear()

# 利用 ace 中的 Editor 建立 Ace2 物件, 其中的輸入變數分別對應到頁面中的編輯區物件
Ace2 = ace.Editor(editor_id="kw_editor1", console_id="kw_console1", container_id="kw__container1", storage_id="kw_py_src1" )

add1to100_url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c48e37714f055c3a0027cbfef59e442a6ef659b9/from_1_add_to_100_1.py"

# 從 gist 取得程式碼
add_src = open(add1to100_url).read()
def add(ev):
    Ace2.editor.setValue(add_src)
    Ace2.editor.scrollToRow(0)
    Ace2.editor.gotoLine(0)
    Ace2.run()

# id 為 "add1to100" 的按鈕點按時, 執行 add 方法
doc["add1to100"].bind('click', add)
</script>
</p>
<p><!-- add 1 to 100 結束--></p>
<p><span node="[object Object]"><!-- editor1 開始 --></span></p>
<p><!-- 用來顯示程式碼的 editor 區域 --></p>
<div id="kw_editor1"></div>
<p><!-- 以下的表單與按鈕與前面的 Javascript doSave 函式以及 FileSaver.min.js 互相配合 --></p>
<p><!-- 存擋表單開始 --></p>
<form><label>Filename: <input id="kw_filename" placeholder="input file name" type="text"/>.py</label> <input onclick="doSave('kw_py_src1', 'kw_filename1');" type="submit" value="Save"/></form>
<p><!-- 存擋表單結束 --></p>
<p></p>
<p><!-- 執行與清除按鈕開始 --></p>
<p><button id="kw_run1">Run</button> <button id="kw_show_console1">Output</button> <button id="kw_clear_console1">清除輸出區</button><button id="clear_bd1">清除繪圖區</button><button onclick="window.location.reload()">Reload</button></p>
<p><!-- 執行與清除按鈕結束 --></p>
<p></p>
<p><!-- 程式執行 ouput 區 --></p>
<div><textarea autocomplete="off" id="kw_console1"></textarea></div>
<p><!-- Brython 程式執行的結果, 都以 brython_div1 作為切入位置 --></p>
<div id="brython_div1"></div>
<p><span node="[object Object]"><!-- editor1 結束 --></span></p>
<hr/>
<p><span node="[object Object]"><!-- ########################################## --></span></p>
<p>從 1 累加到 100 part2:</p>
<p><button id="add1to100part2">1 add to 100</button><button id="cango_three_gears">cango_three_gears</button><button id="bsnake">BSnake</button><button id="aitetris">AI Tetris</button></p>
<p><!-- 請注意, 這裡使用 Javascript 將 localStorage["kw_py_src2"] 中存在近端瀏覽器的程式碼, 由使用者決定存檔名稱--></p>
<p>
<script type="text/python3">
from browser import document as doc
import ace
# 清除畫布
def clear_bd2(ev):
    bd = doc["brython_div2"]
    bd.clear()
Ace3 = ace.Editor(editor_id="kw_editor2", console_id="kw_console2", container_id="kw__container2", storage_id="kw_py_src2" )
# 從 gist 取出程式碼後, 放入 editor 作為 default 程式
def run2():
    # 利用 get 取下 src 變數值
    try:
        url = doc.query["src2"]
    except:
        url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c3a6deaf717f8f2739a4b1392a5ab10936e9693a/from_1_add_to_10_1.py"
    prog = open(url).read()

    # 將程式載入編輯區
    Ace3.editor.setValue(prog)
    Ace3.editor.scrollToRow(0)
    Ace3.editor.gotoLine(0)
    # 直接執行程式
    #ns = {'__name__':'__main__'}
    #exec(prog, ns)
    # 按下 run 按鈕
    Ace3.run()

# 執行程式, 顯示輸出結果與清除輸出結果及對應按鈕綁定
doc['kw_run2'].bind('click', Ace3.run)
doc['kw_show_console2'].bind('click', Ace3.show_console)
doc['kw_clear_console2'].bind('click', Ace3.clear_console)
doc['clear_bd2'].bind('click', clear_bd2)
# 呼叫函式執行
run2()
</script>
</p>
<p><!-- add 1 to 100 part2 開始 -->
<script type="text/python3">
from browser import document as doc
import ace

# 清除畫布
def clear_bd2(ev):
    bd = doc["brython_div2"]
    bd.clear()

# 利用 ace 中的 Editor 建立 Ace2 物件, 其中的輸入變數分別對應到頁面中的編輯區物件
Ace4 = ace.Editor(editor_id="kw_editor2", console_id="kw_console2", container_id="kw__container2", storage_id="kw_py_src2" )

# 透過 Ace4 以類別建立一個通用的 button2, 可以在多個案例中將 gist 程導入編輯區

class button2:
    def __init__(self, url):
        self.url = url

    # 記得加入 event 輸入變數
    def do(self,ev):
        Ace4.editor.setValue(open(self.url).read())
        Ace4.editor.scrollToRow(0)
        Ace4.editor.gotoLine(0)
        Ace4.run()

add1to100_url = "https://gist.githubusercontent.com/mdecourse/0229a8a017091476a79700b8a190f185/raw/c48e37714f055c3a0027cbfef59e442a6ef659b9/from_1_add_to_100_1.py"

# 從 gist 取得程式碼
add_src = open(add1to100_url).read()
def add2(ev):
    Ace4.editor.setValue(add_src)
    Ace4.editor.scrollToRow(0)
    Ace4.editor.gotoLine(0)
    Ace4.run()

# id 為 "add1to100part2" 的按鈕點按時, 執行 add 方法
doc["add1to100part2"].bind('click', add2)
# 以下為運用 button2 class 的通用 gist 程式導入區
################################## cango_three_gears start
cango_three_gears_url = "https://gist.githubusercontent.com/mdecycu/d9082d678096bd58378d6afe2c7fa05d/raw/f7a85d737d6723d5e34c526d5daee990ed92c32b/cango_three_gears_brython_div2.py"
cango_three_gears = button2(cango_three_gears_url)
doc["cango_three_gears"].bind("click", cango_three_gears.do)
################################## cango_three_gears end
################################## bsnake start
bsnake_url = "https://gist.githubusercontent.com/mdecycu/d9082d678096bd58378d6afe2c7fa05d/raw/f7a85d737d6723d5e34c526d5daee990ed92c32b/kmol_snakey.py"
bsnake = button2(bsnake_url)
doc["bsnake"].bind("click", bsnake.do)
################################## bsnake end
################################## aitetris start
aitetris_url = "https://gist.githubusercontent.com/mdecycu/d9082d678096bd58378d6afe2c7fa05d/raw/f7a85d737d6723d5e34c526d5daee990ed92c32b/pygame_to_brython_tetris_ai.py"
aitetris = button2(aitetris_url)
doc["aitetris"].bind("click", aitetris.do)
################################## aitetris end
</script>
</p>
<p><!-- add 1 to 100 part2 結束--></p>
<p><span node="[object Object]"><!-- editor2 開始 --></span></p>
<p><!-- 用來顯示程式碼的 editor 區域 --></p>
<div id="kw_editor2"></div>
<p><!-- 以下的表單與按鈕與前面的 Javascript doSave 函式以及 FileSaver.min.js 互相配合 --></p>
<p><!-- 存擋表單開始 --></p>
<form><label>Filename: <input id="kw_filename2" placeholder="input file name" type="text"/>.py</label> <input onclick="doSave('kw_py_src2', 'kw_filename2');" type="submit" value="Save"/></form>
<p><!-- 存擋表單結束 --></p>
<p></p>
<p><!-- 執行與清除按鈕開始 --></p>
<p><button id="kw_run2">Run</button> <button id="kw_show_console2">Output</button> <button id="kw_clear_console2">清除輸出區</button><button id="clear_bd2">清除繪圖區</button><button onclick="window.location.reload()">Reload</button></p>
<p><!-- 執行與清除按鈕結束 --></p>
<p></p>
<p><!-- 程式執行 ouput 區 --></p>
<div><textarea autocomplete="off" id="kw_console2"></textarea></div>
<p><!-- Brython 程式執行的結果, 都以 brython_div1 作為切入位置 --></p>
<div id="brython_div2"></div>
<p><span node="[object Object]"><!-- editor2 結束 --></span></p>
<hr/></div>